-- [[ SISTEMA DE FORÇAR ATUALIZAÇÃO DO GITHUB COM CACHE BUSTER ]]
local function GetLatestGitHubScript(url)
    local timestamp = math.floor(tick() * 1000)
    local random = math.random(10000, 99999)
    local cacheBuster = "?v=" .. timestamp .. "_" .. random
    
    local fullUrl = url
    if string.find(url, "?") then
        fullUrl = url .. "&t=" .. timestamp .. "_" .. random
    else
        fullUrl = url .. cacheBuster
    end
    
    return fullUrl
end

local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local LocalPlayer = Players.LocalPlayer

-- [[ STATE VARIABLES ]]
local States = {
    ESP_Players = false,
    ESP_Bandidos = false,
    ESP_Policiais = false,
    ESP_Prisioneiros = false,
    Bypass_Doors = false,
    Auto_KeyCard = false,
    Auto_M9 = false,
    BlindShot_ESP = false,
    Auto_Trophy = false,
    Anti_AFK = false,
    Brainrot_Farm = false,
    
    -- FNAF States
    FNAF_ESP_Animatronics = false,
    FNAF_ESP_Fuses = false,
    FNAF_ESP_Batteries = false,
    FNAF_ESP_Pliers = false,
    FNAF_ESP_Screwdriver = false,
    FNAF_ESP_Players = false,
    FNAF_ESP_Cabinet = false,
    FNAF_ESP_Camera = false,
    FNAF_ESP_Flashlight = false,
    FNAF_ESP_All = false,
    
    -- FNAF Utilities States
    FNAF_ClockGame = false,
    FNAF_ClockPuppet = false,
    FNAF_FullBrightness = false,
    FNAF_Speed = false,
    
    Westbound_ESP_Players = false,
    Westbound_ESP_Animals = false,
    Westbound_ESP_DistanceName = false,
    Westbound_ESP_Name = false
}

-- [[ SISTEMA DE LIMPEZA TOTAL - CORRIGIDO ]]
local CleanupSystem = {
    Running = false,
    Connections = {},
    ScriptsToClean = {}
}

function CleanupSystem:RegisterScript(name, cleanupFunction)
    self.ScriptsToClean[name] = cleanupFunction
end

function CleanupSystem:ExecuteLoadstringForCleanup(url)
    local success, result = pcall(function()
        local fullUrl = GetLatestGitHubScript(url)
        return loadstring(game:HttpGet(fullUrl, true))()
    end)
    
    if success then
        return true
    else
        warn("[Vortex Hub] Erro ao executar loadstring de limpeza: " .. url, result)
        return false
    end
end

function CleanupSystem:CleanupAll()
    if self.Running then return end
    self.Running = true
    
    print("[Vortex Hub] Iniciando limpeza total...")
    
    -- Desativar todos os estados
    for stateName, _ in pairs(States) do
        States[stateName] = false
    end
    
    -- Desativar ESPs do Prison Life
    if PrisonLife then
        -- ESP Players
        if PrisonLife.ESP_Players_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/ESP_REMOVE/ESP_RemoveESPPlayers")
            PrisonLife.ESP_Players_Active = false
        end
        
        -- ESP Bandits
        if PrisonLife.ESP_Bandits_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/ESP_REMOVE/ESP_RemoveESPBandits")
            PrisonLife.ESP_Bandits_Active = false
        end
        
        -- ESP Polices
        if PrisonLife.ESP_Polices_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/ESP_REMOVE/ESP_RemoveESPPolices")
            PrisonLife.ESP_Polices_Active = false
        end
        
        -- ESP Prisoners
        if PrisonLife.ESP_Prisoners_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/ESP_REMOVE/ESP_RemoveESPPrisoners")
            PrisonLife.ESP_Prisoners_Active = false
        end
        
        -- Bypass Doors
        if PrisonLife.BypassDoors_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/UTILITIES_REMOVE/UTILITIES_RemoveBypassDoors")
            PrisonLife.BypassDoors_Active = false
        end
        
        -- Auto KeyCard
        if PrisonLife.AutoKeyCard_Active then
            print("[Vortex Hub] Executando loadstring para desativar Auto KeyCard...")
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/UTILITIES_REMOVE/UTILITIES_RemoveAutoKeyCard")
            PrisonLife.AutoKeyCard_Active = false
        end
        
        -- Auto M9
        if PrisonLife.AutoM9_Active then
            print("[Vortex Hub] Executando loadstring para desativar Auto M9...")
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/UTILITIES_REMOVE/UTILITIES_RemvoeAutoM9")
            PrisonLife.AutoM9_Active = false
        end
    end
    
    -- Desativar Blind Shot ESP
    if BlindShotESP then
        BlindShotESP:Disable()
    end
    
    -- Desativar Auto Trophy
    States.Auto_Trophy = false
    
    -- Desativar Anti-AFK
    if AntiAFK then
        AntiAFK:Disable()
    end
    
    -- Desativar Brainrot Farm
    if BrainrotFarm then
        BrainrotFarm:Disable()
    end
    
    -- Desativar Westbound
    if Westbound then
        if Westbound.ESP_Players_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/Westbound/ESP_REMOVE/ESP_RemoveESPPlayers")
            Westbound.ESP_Players_Active = false
        end
        
        if Westbound.ESP_Animals_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/Westbound/ESP_REMOVE/ESP_RemoveESPAnimals")
            Westbound.ESP_Animals_Active = false
        end
        
        if Westbound.ESP_DistanceName_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/Westbound/ESP_REMOVE/ESP_RemoveESPDistanceEName")
            Westbound.ESP_DistanceName_Active = false
        end
        
        if Westbound.ESP_Name_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/Westbound/ESP_REMOVE/ESP_RemoveESPName")
            Westbound.ESP_Name_Active = false
        end
    end
    
    -- Desativar FNAF usando loadstrings de remoção
    if FNAF then
        -- Desativar ESPs
        if FNAF.ESP_All_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPAll")
            FNAF.ESP_All_Active = false
        end
        if FNAF.ESP_Animatronics_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPAnimatronics")
            FNAF.ESP_Animatronics_Active = false
        end
        if FNAF.ESP_Batteries_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPBatteries")
            FNAF.ESP_Batteries_Active = false
        end
        if FNAF.ESP_Cabinet_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPCabinet")
            FNAF.ESP_Cabinet_Active = false
        end
        if FNAF.ESP_Camera_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPCamera")
            FNAF.ESP_Camera_Active = false
        end
        if FNAF.ESP_Flashlight_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPFlashlight")
            FNAF.ESP_Flashlight_Active = false
        end
        if FNAF.ESP_Fuses_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPFuses")
            FNAF.ESP_Fuses_Active = false
        end
        if FNAF.ESP_Players_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPPlayers")
            FNAF.ESP_Players_Active = false
        end
        if FNAF.ESP_Pliers_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPPliers")
            FNAF.ESP_Pliers_Active = false
        end
        if FNAF.ESP_Screwdriver_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPScrewdriver")
            FNAF.ESP_Screwdriver_Active = false
        end
        
        -- Desativar Utilities
        if FNAF.ClockGame_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/UTILITIES_REMOVE/UTILITIES_RemoveClockGame")
            FNAF.ClockGame_Active = false
        end
        if FNAF.ClockPuppet_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/UTILITIES_REMOVE/UTILITIES_RemoveClockPuppet")
            FNAF.ClockPuppet_Active = false
        end
        if FNAF.FullBrightness_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/UTILITIES_REMOVE/UTILITIES_RemoveFullBrightness")
            FNAF.FullBrightness_Active = false
        end
        if FNAF.Speed_Active then
            self:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/UTILITIES_REMOVE/UTILITIES_RemoveSpeed")
            FNAF.Speed_Active = false
        end
    end
    
    -- Executar limpezas registradas
    for name, cleanupFunc in pairs(self.ScriptsToClean) do
        pcall(cleanupFunc)
    end
    
    -- Limpeza manual de ESPs visuais
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("Highlight") then
            pcall(function() obj:Destroy() end)
        elseif obj:IsA("BillboardGui") and (obj.Name:find("ESP") or obj.Name:find("esp") or obj.Name:find("NomeTag") or obj.Name:find("NameTag")) then
            pcall(function() obj:Destroy() end)
        elseif obj:IsA("Folder") and (obj.Name:find("ESP") or obj.Name:find("esp") or obj.Name:find("Internal")) then
            pcall(function() obj:Destroy() end)
        end
    end
    
    -- Limpar conexões
    for _, conn in ipairs(self.Connections) do
        if conn and typeof(conn) == "RBXScriptConnection" then
            pcall(function() conn:Disconnect() end)
        end
    end
    self.Connections = {}
    
    print("[Vortex Hub] Limpeza total concluída!")
    self.Running = false
end

-- [[ PRISON LIFE LOADSTRING SYSTEMS ]]
local PrisonLife = {
    ESP_Players_Active = false,
    ESP_Bandits_Active = false,
    ESP_Polices_Active = false,
    ESP_Prisoners_Active = false,
    BypassDoors_Active = false,
    AutoKeyCard_Active = false,
    AutoM9_Active = false,
    
    LoadedScripts = {
        ESP_Players = nil,
        ESP_Bandits = nil,
        ESP_Polices = nil,
        ESP_Prisoners = nil
    }
}

function PrisonLife:ExecuteLoadstring(url, scriptName)
    local success, result = pcall(function()
        local fullUrl = GetLatestGitHubScript(url)
        return loadstring(game:HttpGet(fullUrl, true))()
    end)
    
    if success then
        self.LoadedScripts[scriptName] = result
        print("[Vortex Hub] Prison Life: " .. scriptName .. " carregado com sucesso!")
        return true
    else
        warn("[Vortex Hub] Prison Life: Erro ao carregar " .. scriptName .. " -", result)
        self.LoadedScripts[scriptName] = nil
        return false
    end
end

function PrisonLife:ToggleESP_Players(state)
    States.ESP_Players = state
    
    if state then
        if not self.ESP_Players_Active then
            task.spawn(function()
                if self.LoadedScripts["ESP_Players"] then
                    pcall(function()
                        if type(self.LoadedScripts["ESP_Players"]) == "function" then
                            self.LoadedScripts["ESP_Players"] = nil
                        end
                    end)
                end
                
                self.ESP_Players_Active = self:ExecuteLoadstring(
                    "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/PrisonLife/ESP/ESP_Players",
                    "ESP_Players"
                )
                
                if self.ESP_Players_Active then
                    print("[Vortex Hub] Prison Life: ESP Players ATIVADO!")
                    
                    CleanupSystem:RegisterScript("ESP_Players", function()
                        CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/ESP_REMOVE/ESP_RemoveESPPlayers")
                    end)
                else
                    print("[Vortex Hub] Prison Life: Falha ao ativar ESP Players")
                end
            end)
        end
    else
        if self.ESP_Players_Active then
            task.spawn(function()
                local success = CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/ESP_REMOVE/ESP_RemoveESPPlayers")
                
                if success then
                    self.ESP_Players_Active = false
                    self.LoadedScripts["ESP_Players"] = nil
                    print("[Vortex Hub] Prison Life: ESP Players DESATIVADO!")
                else
                    for _, player in pairs(Players:GetPlayers()) do
                        if player ~= LocalPlayer then
                            local char = player.Character
                            if char then
                                for _, part in pairs(char:GetDescendants()) do
                                    if part:IsA("Highlight") then
                                        part:Destroy()
                                    elseif part:IsA("BillboardGui") and part.Name:find("ESP") then
                                        part:Destroy()
                                    end
                                end
                            end
                        end
                    end
                    self.ESP_Players_Active = false
                    self.LoadedScripts["ESP_Players"] = nil
                    print("[Vortex Hub] Prison Life: ESP Players desativado (limpeza manual)")
                end
            end)
        end
    end
end

function PrisonLife:ToggleESP_Bandits(state)
    States.ESP_Bandidos = state
    
    if state then
        if not self.ESP_Bandits_Active then
            task.spawn(function()
                if self.LoadedScripts["ESP_Bandits"] then
                    pcall(function()
                        if type(self.LoadedScripts["ESP_Bandits"]) == "function" then
                            self.LoadedScripts["ESP_Bandits"] = nil
                        end
                    end)
                end
                
                self.ESP_Bandits_Active = self:ExecuteLoadstring(
                    "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/PrisonLife/ESP/ESP_Bandits",
                    "ESP_Bandits"
                )
                
                if self.ESP_Bandits_Active then
                    print("[Vortex Hub] Prison Life: ESP Bandits ATIVADO!")
                    
                    CleanupSystem:RegisterScript("ESP_Bandits", function()
                        CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/ESP_REMOVE/ESP_RemoveESPBandits")
                    end)
                else
                    print("[Vortex Hub] Prison Life: Falha ao ativar ESP Bandits")
                end
            end)
        end
    else
        if self.ESP_Bandits_Active then
            task.spawn(function()
                local success = CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/ESP_REMOVE/ESP_RemoveESPBandits")
                
                if success then
                    self.ESP_Bandits_Active = false
                    self.LoadedScripts["ESP_Bandits"] = nil
                    print("[Vortex Hub] Prison Life: ESP Bandits DESATIVADO!")
                else
                    for _, player in pairs(Players:GetPlayers()) do
                        local char = player.Character
                        if char and player.Team and player.Team.Name == "Criminals" then
                            for _, part in pairs(char:GetDescendants()) do
                                if part:IsA("Highlight") then
                                    part:Destroy()
                                elseif part:IsA("BillboardGui") and part.Name:find("ESP") then
                                    part:Destroy()
                                end
                            end
                        end
                    end
                    self.ESP_Bandits_Active = false
                    self.LoadedScripts["ESP_Bandits"] = nil
                    print("[Vortex Hub] Prison Life: ESP Bandits desativado (limpeza manual)")
                end
            end)
        end
    end
end

function PrisonLife:ToggleESP_Polices(state)
    States.ESP_Policiais = state
    
    if state then
        if not self.ESP_Polices_Active then
            task.spawn(function()
                if self.LoadedScripts["ESP_Polices"] then
                    pcall(function()
                        if type(self.LoadedScripts["ESP_Polices"]) == "function" then
                            self.LoadedScripts["ESP_Polices"] = nil
                        end
                    end)
                end
                
                self.ESP_Polices_Active = self:ExecuteLoadstring(
                    "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/PrisonLife/ESP/ESP_Polices",
                    "ESP_Polices"
                )
                
                if self.ESP_Polices_Active then
                    print("[Vortex Hub] Prison Life: ESP Polices ATIVADO!")
                    
                    CleanupSystem:RegisterScript("ESP_Polices", function()
                        CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/ESP_REMOVE/ESP_RemoveESPPolices")
                    end)
                else
                    print("[Vortex Hub] Prison Life: Falha ao ativar ESP Polices")
                end
            end)
        end
    else
        if self.ESP_Polices_Active then
            task.spawn(function()
                local success = CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/ESP_REMOVE/ESP_RemoveESPPolices")
                
                if success then
                    self.ESP_Polices_Active = false
                    self.LoadedScripts["ESP_Polices"] = nil
                    print("[Vortex Hub] Prison Life: ESP Polices DESATIVADO!")
                else
                    for _, player in pairs(Players:GetPlayers()) do
                        local char = player.Character
                        if char and player.Team and player.Team.Name == "Guards" then
                            for _, part in pairs(char:GetDescendants()) do
                                if part:IsA("Highlight") then
                                    part:Destroy()
                                elseif part:IsA("BillboardGui") and part.Name:find("ESP") then
                                    part:Destroy()
                                end
                            end
                        end
                    end
                    self.ESP_Polices_Active = false
                    self.LoadedScripts["ESP_Polices"] = nil
                    print("[Vortex Hub] Prison Life: ESP Polices desativado (limpeza manual)")
                end
            end)
        end
    end
end

function PrisonLife:ToggleESP_Prisoners(state)
    States.ESP_Prisioneiros = state
    
    if state then
        if not self.ESP_Prisoners_Active then
            task.spawn(function()
                if self.LoadedScripts["ESP_Prisoners"] then
                    pcall(function()
                        if type(self.LoadedScripts["ESP_Prisoners"]) == "function" then
                            self.LoadedScripts["ESP_Prisoners"] = nil
                        end
                    end)
                end
                
                self.ESP_Prisoners_Active = self:ExecuteLoadstring(
                    "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/PrisonLife/ESP/ESP_Prisoners",
                    "ESP_Prisoners"
                )
                
                if self.ESP_Prisoners_Active then
                    print("[Vortex Hub] Prison Life: ESP Prisoners ATIVADO!")
                    
                    CleanupSystem:RegisterScript("ESP_Prisoners", function()
                        CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/ESP_REMOVE/ESP_RemoveESPPrisoners")
                    end)
                else
                    print("[Vortex Hub] Prison Life: Falha ao ativar ESP Prisoners")
                end
            end)
        end
    else
        if self.ESP_Prisoners_Active then
            task.spawn(function()
                local success = CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/ESP_REMOVE/ESP_RemoveESPPrisoners")
                
                if success then
                    self.ESP_Prisoners_Active = false
                    self.LoadedScripts["ESP_Prisoners"] = nil
                    print("[Vortex Hub] Prison Life: ESP Prisoners DESATIVADO!")
                else
                    for _, player in pairs(Players:GetPlayers()) do
                        local char = player.Character
                        if char and player.Team and player.Team.Name == "Inmates" then
                            for _, part in pairs(char:GetDescendants()) do
                                if part:IsA("Highlight") then
                                    part:Destroy()
                                elseif part:IsA("BillboardGui") and part.Name:find("ESP") then
                                    part:Destroy()
                                end
                            end
                        end
                    end
                    self.ESP_Prisoners_Active = false
                    self.LoadedScripts["ESP_Prisoners"] = nil
                    print("[Vortex Hub] Prison Life: ESP Prisoners desativado (limpeza manual)")
                end
            end)
        end
    end
end

function PrisonLife:ToggleBypassDoors(state)
    States.Bypass_Doors = state
    
    if state then
        if not self.BypassDoors_Active then
            task.spawn(function()
                local success = pcall(function()
                    local url = GetLatestGitHubScript("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/PrisonLife/UTILITIES/UTILITIES_BypassDoors")
                    loadstring(game:HttpGet(url, true))()
                end)
                
                if success then
                    self.BypassDoors_Active = true
                    print("[Vortex Hub] Prison Life: Bypass Doors ativado!")
                    
                    CleanupSystem:RegisterScript("BypassDoors", function()
                        CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/UTILITIES_REMOVE/UTILITIES_RemoveBypassDoors")
                    end)
                end
            end)
        end
    else
        if self.BypassDoors_Active then
            task.spawn(function()
                local success = CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/UTILITIES_REMOVE/UTILITIES_RemoveBypassDoors")
                
                if success then
                    self.BypassDoors_Active = false
                    print("[Vortex Hub] Prison Life: Bypass Doors desativado!")
                else
                    self.BypassDoors_Active = false
                    print("[Vortex Hub] Prison Life: Bypass Doors desativado (fallback)")
                end
            end)
        end
    end
end

function PrisonLife:ToggleAutoKeyCard(state)
    States.Auto_KeyCard = state
    
    if state then
        if not self.AutoKeyCard_Active then
            task.spawn(function()
                local success = pcall(function()
                    local url = GetLatestGitHubScript("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/PrisonLife/UTILITIES/UTILITIES_AutoKeyCard")
                    loadstring(game:HttpGet(url, true))()
                end)
                
                if success then
                    self.AutoKeyCard_Active = true
                    print("[Vortex Hub] Prison Life: Auto KeyCard ativado!")
                    
                    CleanupSystem:RegisterScript("AutoKeyCard", function()
                        CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/UTILITIES_REMOVE/UTILITIES_RemoveAutoKeyCard")
                    end)
                end
            end)
        end
    else
        if self.AutoKeyCard_Active then
            task.spawn(function()
                local success = CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/UTILITIES_REMOVE/UTILITIES_RemoveAutoKeyCard")
                
                if success then
                    self.AutoKeyCard_Active = false
                    print("[Vortex Hub] Prison Life: Auto KeyCard desativado via loadstring!")
                else
                    self.AutoKeyCard_Active = false
                    print("[Vortex Hub] Prison Life: Auto KeyCard desativado (fallback)")
                end
            end)
        end
    end
end

function PrisonLife:ToggleAutoM9(state)
    States.Auto_M9 = state
    
    if state then
        if not self.AutoM9_Active then
            task.spawn(function()
                local success = pcall(function()
                    local url = GetLatestGitHubScript("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/PrisonLife/UTILITIES/UTILITIES_AutoM9")
                    loadstring(game:HttpGet(url, true))()
                end)
                
                if success then
                    self.AutoM9_Active = true
                    print("[Vortex Hub] Prison Life: Auto M9 ativado!")
                    
                    CleanupSystem:RegisterScript("AutoM9", function()
                        CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/UTILITIES_REMOVE/UTILITIES_RemvoeAutoM9")
                    end)
                end
            end)
        end
    else
        if self.AutoM9_Active then
            task.spawn(function()
                local success = CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/PrisonLife/UTILITIES_REMOVE/UTILITIES_RemvoeAutoM9")
                
                if success then
                    self.AutoM9_Active = false
                    print("[Vortex Hub] Prison Life: Auto M9 desativado via loadstring!")
                else
                    self.AutoM9_Active = false
                    print("[Vortex Hub] Prison Life: Auto M9 desativado (fallback)")
                end
            end)
        end
    end
end

function PrisonLife:GetAK47()
    task.spawn(function()
        local success = pcall(function()
            local url = GetLatestGitHubScript("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/PrisonLife/PRISONITEMS/PRISON_GetAK")
            loadstring(game:HttpGet(url, true))()
        end)
        
        if success then
            print("[Vortex Hub] Prison Life: Get AK-47 executado!")
        end
    end)
end

function PrisonLife:GetMP5()
    task.spawn(function()
        local success = pcall(function()
            local url = GetLatestGitHubScript("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/PrisonLife/PRISONITEMS/PRISON_GetMp5")
            loadstring(game:HttpGet(url, true))()
        end)
        
        if success then
            print("[Vortex Hub] Prison Life: Get MP5 executado!")
        end
    end)
end

function PrisonLife:GetShotgun()
    task.spawn(function()
        local success = pcall(function()
            local url = GetLatestGitHubScript("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/PrisonLife/PRISONITEMS/PRISON_GetShotgun")
            loadstring(game:HttpGet(url, true))()
        end)
        
        if success then
            print("[Vortex Hub] Prison Life: Get Shotgun executado!")
        end
    end)
end

function PrisonLife:TeleportCriminalSpawn()
    task.spawn(function()
        local success = pcall(function()
            local url = GetLatestGitHubScript("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/PrisonLife/TELEPORTS/TELEPORT_CriminalSpawn")
            loadstring(game:HttpGet(url, true))()
        end)
        
        if success then
            print("[Vortex Hub] Prison Life: Teleport Criminal Spawn executado!")
        end
    end)
end

function PrisonLife:TeleportInsidePrison()
    task.spawn(function()
        local success = pcall(function()
            local url = GetLatestGitHubScript("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/PrisonLife/TELEPORTS/TELEPORT_InsidePrison")
            loadstring(game:HttpGet(url, true))()
        end)
        
        if success then
            print("[Vortex Hub] Prison Life: Teleport Inside Prison executado!")
        end
    end)
end

function PrisonLife:TeleportOutPrison()
    task.spawn(function()
        local success = pcall(function()
            local url = GetLatestGitHubScript("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/PrisonLife/TELEPORTS/TELEPORT_OutPrison")
            loadstring(game:HttpGet(url, true))()
        end)
        
        if success then
            print("[Vortex Hub] Prison Life: Teleport Out Prison executado!")
        end
    end)
end

function PrisonLife:TeleportYardCenter()
    task.spawn(function()
        local success = pcall(function()
            local url = GetLatestGitHubScript("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/PrisonLife/TELEPORTS/TELEPORT_YardCenter")
            loadstring(game:HttpGet(url, true))()
        end)
        
        if success then
            print("[Vortex Hub] Prison Life: Teleport Yard Center executado!")
        end
    end)
end

function PrisonLife:TeleportPoliceCenter()
    task.spawn(function()
        local success = pcall(function()
            local url = GetLatestGitHubScript("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/PrisonLife/TELEPORTS/TELEPORT_PoliceCenter")
            loadstring(game:HttpGet(url, true))()
        end)
        
        if success then
            print("[Vortex Hub] Prison Life: Teleport Police Center executado!")
        end
    end)
end

-- [[ TELEPORT SYSTEM ]]
local TeleportCooldown = false
local LastTeleportTime = 0
local TELEPORT_COOLDOWN = 2

local function SimpleTeleport(cframe)
    if TeleportCooldown then
        local waitTime = TELEPORT_COOLDOWN - (tick() - LastTeleportTime)
        if waitTime > 0 then
            print("[Vortex Hub] Wait " .. math.ceil(waitTime) .. "s before teleporting again")
            return false
        end
    end
    
    local char = LocalPlayer.Character
    local humanoidRootPart = char and char:FindFirstChild("HumanoidRootPart")
    
    if not humanoidRootPart then
        print("[Vortex Hub] Character not found!")
        return false
    end
    
    TeleportCooldown = true
    LastTeleportTime = tick()
    
    humanoidRootPart.CFrame = cframe
    task.wait(0.1)
    
    print("[Vortex Hub] Teleport completed!")
    
    task.spawn(function()
        task.wait(TELEPORT_COOLDOWN)
        TeleportCooldown = false
    end)
    
    return true
end

-- [[ FUNCTION TO GET FORMATTED TEAM NAME ]]
local function GetTeamName()
    local team = LocalPlayer.Team
    if not team then return "No Team" end
    
    local teamNames = {
        ["Criminals"] = "Criminals",
        ["Guards"] = "Guards",
        ["Inmates"] = "Inmates",
        ["Neutral"] = "Neutral"
    }
    
    return teamNames[team.Name] or team.Name
end

-- [[ TELEPORT TO TROPHY ]]
local function TeleportToTrophy()
    pcall(function()
        local trophy = workspace:FindFirstChild("Trophy")
        
        if not trophy then
            for _, obj in pairs(workspace:GetChildren()) do
                if obj:IsA("Model") and string.find(obj.Name:lower(), "trophy") then
                    trophy = obj
                    break
                end
            end
        end
        
        if not trophy then
            print("[Blind Shot] Trophy not found in workspace!")
            return false
        end
        
        local char = LocalPlayer.Character
        local humanoidRootPart = char and char:FindFirstChild("HumanoidRootPart")
        
        if humanoidRootPart then
            local trophyPosition
            if trophy:IsA("Model") then
                trophyPosition = trophy:GetModelCFrame().Position
            else
                trophyPosition = trophy.Position
            end
            
            local teleportCFrame = CFrame.new(trophyPosition + Vector3.new(0, 5, 0))
            
            if SimpleTeleport(teleportCFrame) then
                print("[Blind Shot] Successfully teleported to trophy!")
                return true
            else
                print("[Blind Shot] Failed to teleport")
                return false
            end
        else
            print("[Blind Shot] Character not found!")
            return false
        end
    end)
end

-- [[ ESP DEFINITIVO PARA BLIND SHOT ]]
local BlindShotESP = {
    Active = false,
    Connections = {},
    RenderConnection = nil,
    Highlights = {}
}

local function ForceVisibility()
    if not BlindShotESP.Active then return end
    
    local jogadoresVivos = workspace:FindFirstChild("jogadoresVivos")
    if not jogadoresVivos then return end

    for _, v in ipairs(jogadoresVivos:GetChildren()) do
        if v.Name ~= LocalPlayer.Name then
            local char = workspace:FindFirstChild(v.Name)
            if char and char:IsA("Model") then
                for _, part in ipairs(char:GetDescendants()) do
                    if part.Name == "hitbox" or part.Name == "HumanoidRootPart" then
                        if part.Transparency ~= 1 then
                            part.Transparency = 1
                        end
                    elseif part:IsA("BasePart") then
                        if part.Transparency ~= 0 then
                            part.Transparency = 0
                        end
                    elseif part:IsA("Decal") or part:IsA("Texture") then
                        if part.Transparency ~= 0 then
                            part.Transparency = 0
                        end
                    elseif part:IsA("ParticleEmitter") or part:IsA("Beam") or part:IsA("Trail") then
                        if part.Enabled == false then
                            part.Enabled = true
                        end
                    end
                end
            end
        end
    end

    for _, h in ipairs(workspace:GetChildren()) do
        if h:IsA("Highlight") and h.Name == "Highlight_TEMP" then
            h.FillTransparency = 1
            h.OutlineTransparency = 0
        end
    end
    
    for playerName, highlight in pairs(BlindShotESP.Highlights) do
        if highlight and highlight.Parent then
            highlight:Destroy()
        end
    end
    BlindShotESP.Highlights = {}
end

local function BypassJump(char)
    if not BlindShotESP.Active then return end
    
    local hum = char:WaitForChild("Humanoid")
    hum:GetPropertyChangedSignal("JumpHeight"):Connect(function()
        if hum.JumpHeight == 0 then
            hum.JumpHeight = 50
        end
    end)
end

function BlindShotESP:Initialize()
    self:CleanupHighlights()
    
    self.RenderConnection = RunService.RenderStepped:Connect(function()
        pcall(ForceVisibility)
    end)
    
    if LocalPlayer.Character then 
        BypassJump(LocalPlayer.Character) 
    end
    LocalPlayer.CharacterAdded:Connect(BypassJump)
end

function BlindShotESP:CleanupHighlights()
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("Highlight") and (obj.Name == "Highlight_TEMP" or obj.Name:find("ESP")) then
            pcall(function() obj:Destroy() end)
        end
    end
    
    for playerName, highlight in pairs(self.Highlights) do
        if highlight and highlight.Parent then
            pcall(function() highlight:Destroy() end)
        end
    end
    self.Highlights = {}
end

function BlindShotESP:Enable()
    if self.Active then return end
    
    self.Active = true
    self:Initialize()
    print("[Blind Shot ESP] Ativado!")
    
    CleanupSystem:RegisterScript("BlindShotESP", function()
        self:Disable()
    end)
end

function BlindShotESP:Disable()
    if not self.Active then return end
    
    self.Active = false
    
    if self.RenderConnection then
        self.RenderConnection:Disconnect()
        self.RenderConnection = nil
    end
    
    for _, conn in ipairs(self.Connections) do
        if conn then
            pcall(function() conn:Disconnect() end)
        end
    end
    
    self.Connections = {}
    self:CleanupHighlights()
    
    print("[Blind Shot ESP] Desativado!")
end

-- [[ ANTI-AFK SYSTEM ]]
local AntiAFK = {
    Active = false,
    Connection = nil
}

function AntiAFK:Enable()
    if self.Active then return end
    
    self.Active = true
    
    local VirtualUser = game:GetService("VirtualUser")
    
    self.Connection = LocalPlayer.Idled:Connect(function()
        VirtualUser:CaptureController()
        VirtualUser:ClickButton2(Vector2.new())
    end)
    
    print("[Vortex Hub] Anti-AFK ativado!")
    
    CleanupSystem:RegisterScript("AntiAFK", function()
        self:Disable()
    end)
end

function AntiAFK:Disable()
    if not self.Active then return end
    
    self.Active = false
    
    if self.Connection then
        self.Connection:Disconnect()
        self.Connection = nil
    end
    
    print("[Vortex Hub] Anti-AFK desativado!")
end

-- [[ AUTO TROPHY LOOP ]]
local AutoTrophyRunning = false
local function StartAutoTrophy()
    if AutoTrophyRunning then return end
    AutoTrophyRunning = true
    
    task.spawn(function()
        while States.Auto_Trophy do
            TeleportToTrophy()
            
            for i = 1, 20 do
                if not States.Auto_Trophy then break end
                task.wait(1)
            end
        end
        
        AutoTrophyRunning = false
    end)
end

-- [[ BRAINROT FARM SCRIPT ]]
local BrainrotFarm = {
    Active = false,
    Running = false
}

local function StartBrainrotFarm()
    if BrainrotFarm.Running then return end
    BrainrotFarm.Running = true
    
    task.spawn(function()
        local player = Players.LocalPlayer
        local character = player.Character or player.CharacterAdded:Wait()
        local rootPart = character:WaitForChild("HumanoidRootPart")
        
        local brainrotsFolder = workspace:WaitForChild("Brainrots")
        local collectedFolder = player:WaitForChild("brainrotsCollected")
        
        local safePosition = rootPart.CFrame
        
        while States.Brainrot_Farm do
            local allItems = brainrotsFolder:GetChildren()
            
            for i = 1, #allItems do
                local currentItem = allItems[i]
                
                if currentItem and not collectedFolder:FindFirstChild(currentItem.Name) then
                    local targetCFrame = nil
                    if currentItem:IsA("BasePart") then
                        targetCFrame = currentItem.CFrame
                    elseif currentItem:IsA("Model") then
                        if currentItem.PrimaryPart then
                            targetCFrame = currentItem.PrimaryPart.CFrame
                        else
                            local childPart = currentItem:FindFirstChildWhichIsA("BasePart", true)
                            if childPart then
                                targetCFrame = childPart.CFrame
                            end
                        end
                    end
                    
                    if targetCFrame then
                        rootPart.CFrame = targetCFrame
                        task.wait(0.2)
                        rootPart.CFrame = safePosition
                        task.wait(0.1)
                    end
                end
            end

            task.wait(0.1)
        end
        
        BrainrotFarm.Running = false
    end)
end

function BrainrotFarm:Enable()
    if self.Active then return end
    
    self.Active = true
    StartBrainrotFarm()
    print("[Vortex Hub] Brainrot Farm ativado!")
    
    CleanupSystem:RegisterScript("BrainrotFarm", function()
        self:Disable()
    end)
end

function BrainrotFarm:Disable()
    if not self.Active then return end
    
    self.Active = false
    print("[Vortex Hub] Brainrot Farm desativado")
end

-- [[ WESTBOUND SYSTEMS ]]
local Westbound = {
    ESP_Players_Active = false,
    ESP_Animals_Active = false,
    ESP_DistanceName_Active = false,
    ESP_Name_Active = false
}

function Westbound:ToggleESP_Players(state)
    States.Westbound_ESP_Players = state
    
    if state then
        if not self.ESP_Players_Active then
            task.spawn(function()
                local success = pcall(function()
                    local url = GetLatestGitHubScript("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/Westbound/ESP/ESP_Players")
                    loadstring(game:HttpGet(url, true))()
                end)
                
                if success then
                    self.ESP_Players_Active = true
                    print("[Vortex Hub] Westbound: ESP Players ativado!")
                    
                    CleanupSystem:RegisterScript("WestboundESPPlayers", function()
                        CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/Westbound/ESP_REMOVE/ESP_RemoveESPPlayers")
                    end)
                else
                    self.ESP_Players_Active = false
                end
            end)
        end
    else
        if self.ESP_Players_Active then
            task.spawn(function()
                local success = CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/Westbound/ESP_REMOVE/ESP_RemoveESPPlayers")
                
                if success then
                    self.ESP_Players_Active = false
                    print("[Vortex Hub] Westbound: ESP Players desativado!")
                else
                    self.ESP_Players_Active = false
                end
            end)
        end
    end
end

function Westbound:ToggleESP_Animals(state)
    States.Westbound_ESP_Animals = state
    
    if state then
        if not self.ESP_Animals_Active then
            task.spawn(function()
                local success = pcall(function()
                    local url = GetLatestGitHubScript("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/Westbound/ESP/ESP_Animals")
                    loadstring(game:HttpGet(url, true))()
                end)
                
                if success then
                    self.ESP_Animals_Active = true
                    print("[Vortex Hub] Westbound: ESP Animals ativado!")
                    
                    CleanupSystem:RegisterScript("WestboundESPAnimals", function()
                        CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/Westbound/ESP_REMOVE/ESP_RemoveESPAnimals")
                    end)
                else
                    self.ESP_Animals_Active = false
                end
            end)
        end
    else
        if self.ESP_Animals_Active then
            task.spawn(function()
                local success = CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/Westbound/ESP_REMOVE/ESP_RemoveESPAnimals")
                
                if success then
                    self.ESP_Animals_Active = false
                    print("[Vortex Hub] Westbound: ESP Animals desativado!")
                else
                    self.ESP_Animals_Active = false
                end
            end)
        end
    end
end

function Westbound:ToggleESP_DistanceName(state)
    States.Westbound_ESP_DistanceName = state
    
    if state then
        if not self.ESP_DistanceName_Active then
            task.spawn(function()
                local success = pcall(function()
                    local url = GetLatestGitHubScript("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/Westbound/ESP/ESP_DistanceEName")
                    loadstring(game:HttpGet(url, true))()
                end)
                
                if success then
                    self.ESP_DistanceName_Active = true
                    print("[Vortex Hub] Westbound: ESP Distance + Name ativado!")
                    
                    CleanupSystem:RegisterScript("WestboundESPDistanceName", function()
                        CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/Westbound/ESP_REMOVE/ESP_RemoveESPDistanceEName")
                    end)
                else
                    self.ESP_DistanceName_Active = false
                end
            end)
        end
    else
        if self.ESP_DistanceName_Active then
            task.spawn(function()
                local success = CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/Westbound/ESP_REMOVE/ESP_RemoveESPDistanceEName")
                
                if success then
                    self.ESP_DistanceName_Active = false
                    print("[Vortex Hub] Westbound: ESP Distance + Name desativado!")
                else
                    self.ESP_DistanceName_Active = false
                end
            end)
        end
    end
end

function Westbound:ToggleESP_Name(state)
    States.Westbound_ESP_Name = state
    
    if state then
        if not self.ESP_Name_Active then
            task.spawn(function()
                local success = pcall(function()
                    local url = GetLatestGitHubScript("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/Westbound/ESP/ESP_Name")
                    loadstring(game:HttpGet(url, true))()
                end)
                
                if success then
                    self.ESP_Name_Active = true
                    print("[Vortex Hub] Westbound: ESP Name ativado!")
                    
                    CleanupSystem:RegisterScript("WestboundESPName", function()
                        CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/Westbound/ESP_REMOVE/ESP_RemoveESPName")
                    end)
                else
                    self.ESP_Name_Active = false
                end
            end)
        end
    else
        if self.ESP_Name_Active then
            task.spawn(function()
                local success = CleanupSystem:ExecuteLoadstringForCleanup("https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/Westbound/ESP_REMOVE/ESP_RemoveESPName")
                
                if success then
                    self.ESP_Name_Active = false
                    print("[Vortex Hub] Westbound: ESP Name desativado!")
                else
                    self.ESP_Name_Active = false
                end
            end)
        end
    end
end

-- [[ FNAF: ETERNAL NIGHTS SYSTEMS - COMPLETAMENTE ATUALIZADO ]]
local FNAF = {
    -- ESP States
    ESP_Animatronics_Active = false,
    ESP_Fuses_Active = false,
    ESP_Batteries_Active = false,
    ESP_Pliers_Active = false,
    ESP_Screwdriver_Active = false,
    ESP_Players_Active = false,
    ESP_Cabinet_Active = false,
    ESP_Camera_Active = false,
    ESP_Flashlight_Active = false,
    ESP_All_Active = false,
    
    -- Utilities States
    ClockGame_Active = false,
    ClockPuppet_Active = false,
    FullBrightness_Active = false,
    Speed_Active = false,
    
    LoadedScripts = {}
}

-- Função genérica para ativar/desativar ESPs do FNAF
function FNAF:ToggleESP(espType, state)
    local activateUrl = ""
    local removeUrl = ""
    local stateName = ""
    
    -- Mapear tipo para URLs
    if espType == "All" then
        activateUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/ESP/ESP_All"
        removeUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPAll"
        stateName = "FNAF_ESP_All"
    elseif espType == "Animatronics" then
        activateUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/ESP/ESP_Animatronics"
        removeUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPAnimatronics"
        stateName = "FNAF_ESP_Animatronics"
    elseif espType == "Batteries" then
        activateUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/ESP/ESP_Batteries"
        removeUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPBatteries"
        stateName = "FNAF_ESP_Batteries"
    elseif espType == "Cabinet" then
        activateUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/ESP/ESP_Cabinet"
        removeUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPCabinet"
        stateName = "FNAF_ESP_Cabinet"
    elseif espType == "Camera" then
        activateUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/ESP/ESP_Camera"
        removeUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPCamera"
        stateName = "FNAF_ESP_Camera"
    elseif espType == "Flashlight" then
        activateUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/ESP/ESP_Flashlight"
        removeUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPFlashlight"
        stateName = "FNAF_ESP_Flashlight"
    elseif espType == "Fuses" then
        activateUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/ESP/ESP_Fuses"
        removeUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPFuses"
        stateName = "FNAF_ESP_Fuses"
    elseif espType == "Players" then
        activateUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/ESP/ESP_Players"
        removeUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPPlayers"
        stateName = "FNAF_ESP_Players"
    elseif espType == "Pliers" then
        activateUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/ESP/ESP_Pliers"
        removeUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPPliers"
        stateName = "FNAF_ESP_Pliers"
    elseif espType == "Screwdriver" then
        activateUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/ESP/ESP_Screwdriver"
        removeUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/ESP_REMOVE/ESP_RemoveESPScrewdriver"
        stateName = "FNAF_ESP_Screwdriver"
    else
        warn("[Vortex Hub] FNAF: Tipo de ESP inválido: " .. tostring(espType))
        return
    end
    
    -- Atualizar estado
    States[stateName] = state
    
    if state then
        -- Ativar ESP
        task.spawn(function()
            local success = pcall(function()
                local fullUrl = GetLatestGitHubScript(activateUrl)
                return loadstring(game:HttpGet(fullUrl, true))()
            end)
            
            if success then
                self[espType .. "_Active"] = true
                print("[Vortex Hub] FNAF: ESP " .. espType .. " ativado!")
                
                -- Registrar limpeza
                CleanupSystem:RegisterScript("FNAF_ESP_" .. espType, function()
                    CleanupSystem:ExecuteLoadstringForCleanup(removeUrl)
                end)
            else
                self[espType .. "_Active"] = false
                warn("[Vortex Hub] FNAF: Erro ao ativar ESP " .. espType)
            end
        end)
    else
        -- Desativar ESP
        if self[espType .. "_Active"] then
            task.spawn(function()
                local success = CleanupSystem:ExecuteLoadstringForCleanup(removeUrl)
                
                if success then
                    self[espType .. "_Active"] = false
                    print("[Vortex Hub] FNAF: ESP " .. espType .. " desativado!")
                else
                    self[espType .. "_Active"] = false
                    print("[Vortex Hub] FNAF: ESP " .. espType .. " desativado (fallback)")
                end
            end)
        end
    end
end

-- Funções específicas para cada tipo de ESP
function FNAF:ApplyESP_All(state)
    self:ToggleESP("All", state)
end

function FNAF:ApplyESP_Animatronics(state)
    self:ToggleESP("Animatronics", state)
end

function FNAF:ApplyESP_Batteries(state)
    self:ToggleESP("Batteries", state)
end

function FNAF:ApplyESP_Cabinet(state)
    self:ToggleESP("Cabinet", state)
end

function FNAF:ApplyESP_Camera(state)
    self:ToggleESP("Camera", state)
end

function FNAF:ApplyESP_Flashlight(state)
    self:ToggleESP("Flashlight", state)
end

function FNAF:ApplyESP_Fuses(state)
    self:ToggleESP("Fuses", state)
end

function FNAF:ApplyESP_Players(state)
    self:ToggleESP("Players", state)
end

function FNAF:ApplyESP_Pliers(state)
    self:ToggleESP("Pliers", state)
end

function FNAF:ApplyESP_Screwdriver(state)
    self:ToggleESP("Screwdriver", state)
end

-- Função para executar PULL ITEMS (botões executar)
function FNAF:ExecutePullItem(itemType)
    local url = ""
    
    if itemType == "AllItems" then
        url = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/PULLITEMS/PULL_AllItems"
    elseif itemType == "Batteries" then
        url = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/PULLITEMS/PULL_Batteries"
    elseif itemType == "Camera" then
        url = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/PULLITEMS/PULL_Camera"
    elseif itemType == "Fuses" then
        url = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/PULLITEMS/PULL_Fuses"
    elseif itemType == "Pliers" then
        url = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/PULLITEMS/PULL_Pliers"
    elseif itemType == "Screwdriver" then
        url = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/PULLITEMS/PULL_Screwdriver"
    else
        warn("[Vortex Hub] FNAF: Tipo de Pull Item inválido: " .. tostring(itemType))
        return
    end
    
    task.spawn(function()
        local success = pcall(function()
            local fullUrl = GetLatestGitHubScript(url)
            return loadstring(game:HttpGet(fullUrl, true))()
        end)
        
        if success then
            print("[Vortex Hub] FNAF: Pull " .. itemType .. " executado com sucesso!")
        else
            warn("[Vortex Hub] FNAF: Erro ao executar Pull " .. itemType)
        end
    end)
end

-- Função para ativar/desativar UTILITIES
function FNAF:ToggleUtility(utilityType, state)
    local activateUrl = ""
    local removeUrl = ""
    local stateName = ""
    
    -- Mapear tipo para URLs
    if utilityType == "ClockGame" then
        activateUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/UTILITIES/PLAYER_ClockGame"
        removeUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/UTILITIES_REMOVE/UTILITIES_RemoveClockGame"
        stateName = "FNAF_ClockGame"
    elseif utilityType == "ClockPuppet" then
        activateUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/UTILITIES/PLAYER_ClockPuppet"
        removeUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/UTILITIES_REMOVE/UTILITIES_RemoveClockPuppet"
        stateName = "FNAF_ClockPuppet"
    elseif utilityType == "FullBrightness" then
        activateUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/UTILITIES/PLAYER_FullBrightness"
        removeUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/UTILITIES_REMOVE/UTILITIES_RemoveFullBrightness"
        stateName = "FNAF_FullBrightness"
    elseif utilityType == "Speed" then
        activateUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Games/FNAFEternalNights/UTILITIES/PLAYER_Speed"
        removeUrl = "https://raw.githubusercontent.com/Mickey123m/Vortex-Hub/refs/heads/main/Models/FNAFEternalNights/UTILITIES_REMOVE/UTILITIES_RemoveSpeed"
        stateName = "FNAF_Speed"
    else
        warn("[Vortex Hub] FNAF: Tipo de Utility inválido: " .. tostring(utilityType))
        return
    end
    
    -- Atualizar estado
    States[stateName] = state
    
    if state then
        -- Ativar Utility
        task.spawn(function()
            local success = pcall(function()
                local fullUrl = GetLatestGitHubScript(activateUrl)
                return loadstring(game:HttpGet(fullUrl, true))()
            end)
            
            if success then
                self[utilityType .. "_Active"] = true
                print("[Vortex Hub] FNAF: Utility " .. utilityType .. " ativado!")
                
                -- Registrar limpeza
                CleanupSystem:RegisterScript("FNAF_Utility_" .. utilityType, function()
                    CleanupSystem:ExecuteLoadstringForCleanup(removeUrl)
                end)
            else
                self[utilityType .. "_Active"] = false
                warn("[Vortex Hub] FNAF: Erro ao ativar Utility " .. utilityType)
            end
        end)
    else
        -- Desativar Utility
        if self[utilityType .. "_Active"] then
            task.spawn(function()
                local success = CleanupSystem:ExecuteLoadstringForCleanup(removeUrl)
                
                if success then
                    self[utilityType .. "_Active"] = false
                    print("[Vortex Hub] FNAF: Utility " .. utilityType .. " desativado!")
                else
                    self[utilityType .. "_Active"] = false
                    print("[Vortex Hub] FNAF: Utility " .. utilityType .. " desativado (fallback)")
                end
            end)
        end
    end
end

-- Funções específicas para cada Utility
function FNAF:ToggleClockGame(state)
    self:ToggleUtility("ClockGame", state)
end

function FNAF:ToggleClockPuppet(state)
    self:ToggleUtility("ClockPuppet", state)
end

function FNAF:ToggleFullBrightness(state)
    self:ToggleUtility("FullBrightness", state)
end

function FNAF:ToggleSpeed(state)
    self:ToggleUtility("Speed", state)
end

-- Teleports
function FNAF:TeleportSecurityRoom()
    pcall(function()
        local target = workspace:WaitForChild("Game"):WaitForChild("Sistema"):WaitForChild("DoorSecurity"):WaitForChild("PackDoor"):WaitForChild("Door"):WaitForChild("Grade")
        
        local character = LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            if target:IsA("BasePart") or target:IsA("MeshPart") then
                character:PivotTo(target.CFrame * CFrame.new(0, 3, 0))
            else
                character:PivotTo(target:GetPivot() * CFrame.new(0, 3, 0))
            end
        end
    end)
end

function FNAF:TeleportPuppetClock()
    pcall(function()
        local target = workspace:WaitForChild("Game"):WaitForChild("Sistema"):WaitForChild("Puppet"):WaitForChild("Door")
        
        local character = LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            local targetPos = target:GetPivot()
            character:PivotTo(targetPos * CFrame.new(0, 3, 0))
        end
    end)
end

function FNAF:TeleportAboveMap()
    pcall(function()
        local character = LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            local hrp = character.HumanoidRootPart
            local newPos = hrp.CFrame + Vector3.new(0, 200, 0)
            character:PivotTo(newPos)
        end
    end)
end

function FNAF:TeleportFuseRoom()
    pcall(function()
        local target = workspace:WaitForChild("Game"):WaitForChild("Sistema"):WaitForChild("Gerador"):WaitForChild("Fusiveis")
        
        local character = LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            local targetPos = target:GetPivot()
            character:PivotTo(targetPos * CFrame.new(0, 3, 0))
        end
    end)
end

-- [[ INTERFACE ]]
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "VortexHub_Final"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.DisplayOrder = 999999999

local success, coreGui = pcall(function() return game:GetService("CoreGui") end)
ScreenGui.Parent = success and coreGui or LocalPlayer:WaitForChild("PlayerGui")

local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 650, 0, 450)
MainFrame.Position = UDim2.new(0.5, -325, 0.5, -225)
MainFrame.BackgroundColor3 = Color3.fromHex("17171C")
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Selectable = true
MainFrame.Parent = ScreenGui

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 8)
MainCorner.Parent = MainFrame

local MainStroke = Instance.new("UIStroke")
MainStroke.Name = "MainStroke"
MainStroke.Thickness = 1
MainStroke.Color = Color3.fromHex("25252D")
MainStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
MainStroke.LineJoinMode = Enum.LineJoinMode.Round
MainStroke.Parent = MainFrame

local TopBar = Instance.new("Frame")
TopBar.Name = "TopBar"
TopBar.Size = UDim2.new(1, 0, 0, 38)
TopBar.BackgroundColor3 = Color3.fromHex("1C1C22")
TopBar.BorderSizePixel = 0
TopBar.Active = true
TopBar.Parent = MainFrame

local TopCorner = Instance.new("UICorner")
TopCorner.CornerRadius = UDim.new(0, 8)
TopCorner.Parent = TopBar

local HeaderSeparator = Instance.new("Frame")
HeaderSeparator.Name = "Separator"
HeaderSeparator.Size = UDim2.new(1, 0, 0, 1)
HeaderSeparator.Position = UDim2.new(0, 0, 0, 38)
HeaderSeparator.BackgroundColor3 = Color3.fromHex("25252D")
HeaderSeparator.BorderSizePixel = 0
HeaderSeparator.ZIndex = 5
HeaderSeparator.Parent = MainFrame

local Title = Instance.new("TextLabel")
Title.Text = "VORTEX HUB"
Title.Size = UDim2.new(0, 100, 1, 0)
Title.Position = UDim2.new(0, 15, 0, 0)
Title.TextColor3 = Color3.fromRGB(138, 43, 226)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 13
Title.BackgroundTransparency = 1
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Parent = TopBar

local VersionLabelTop = Instance.new("TextLabel")
VersionLabelTop.Text = "v2.3.0"
VersionLabelTop.Size = UDim2.new(0, 50, 1, 0)
VersionLabelTop.Position = UDim2.new(0, 105, 0, 0)
VersionLabelTop.TextColor3 = Color3.fromRGB(120, 120, 120)
VersionLabelTop.Font = Enum.Font.Gotham
VersionLabelTop.TextSize = 11
VersionLabelTop.BackgroundTransparency = 1
VersionLabelTop.TextXAlignment = Enum.TextXAlignment.Left
VersionLabelTop.Parent = TopBar

local ButtonHolder = Instance.new("Frame")
ButtonHolder.Size = UDim2.new(0, 40, 1, 0)
ButtonHolder.Position = UDim2.new(1, -45, 0, 0)
ButtonHolder.BackgroundTransparency = 1
ButtonHolder.Parent = TopBar

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.FillDirection = Enum.FillDirection.Horizontal
UIListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Right
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Padding = UDim.new(0, 8)
UIListLayout.VerticalAlignment = Enum.VerticalAlignment.Center
UIListLayout.Parent = ButtonHolder

local function CreateTopButton(text, order)
    local btn = Instance.new("TextButton")
    btn.Text = text
    btn.Size = UDim2.new(0, 24, 0, 24)
    btn.BackgroundTransparency = 1
    btn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    btn.TextColor3 = Color3.fromRGB(150, 150, 150)
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 14
    btn.LayoutOrder = order
    btn.AutoButtonColor = false
    btn.Active = true
    btn.Parent = ButtonHolder

    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0, 6)
    btnCorner.Parent = btn
    return btn
end

local CloseBtn = CreateTopButton("X", 1)

local function ApplyHover(button, hoverColor)
    button.MouseEnter:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.2), {
            BackgroundTransparency = 0,
            BackgroundColor3 = hoverColor,
            TextColor3 = Color3.fromRGB(255, 255, 255)
        }):Play()
    end)
    button.MouseLeave:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.2), {
            BackgroundTransparency = 1,
            TextColor3 = Color3.fromRGB(150, 150, 150)
        }):Play()
    end)
end

ApplyHover(CloseBtn, Color3.fromRGB(200, 45, 45))

CloseBtn.MouseButton1Click:Connect(function()
    print("[Vortex Hub] Fechando hub e limpando tudo...")
    CleanupSystem:CleanupAll()
    ScreenGui:Destroy()
    print("[Vortex Hub] Interface fechada")
end)

local SideBar = Instance.new("Frame")
SideBar.Name = "SideBar"
SideBar.Size = UDim2.new(0, 150, 1, -38)
SideBar.Position = UDim2.new(0, 0, 0, 38)
SideBar.BackgroundColor3 = Color3.fromHex("121216")
SideBar.BorderSizePixel = 0
SideBar.Active = true
SideBar.Parent = MainFrame

local SideBarCorner = Instance.new("UICorner")
SideBarCorner.CornerRadius = UDim.new(0, 8)
SideBarCorner.Parent = SideBar

local SideBarFix = Instance.new("Frame")
SideBarFix.Name = "Fix"
SideBarFix.Size = UDim2.new(0, 20, 1, 0)
SideBarFix.Position = UDim2.new(1, -20, 0, 0)
SideBarFix.BackgroundColor3 = Color3.fromHex("121216")
SideBarFix.BorderSizePixel = 0
SideBarFix.Parent = SideBar

local VerticalSeparator = Instance.new("Frame")
VerticalSeparator.Size = UDim2.new(0, 1, 1, 0)
VerticalSeparator.Position = UDim2.new(1, 0, 0, 0)
VerticalSeparator.BackgroundColor3 = Color3.fromHex("25252D")
VerticalSeparator.BorderSizePixel = 0
VerticalSeparator.Parent = SideBar

local SideTitle = Instance.new("TextLabel")
SideTitle.Text = "VORTEX HUB"
SideTitle.Size = UDim2.new(1, 0, 0, 45)
SideTitle.Position = UDim2.new(0, 15, 0, 0)
SideTitle.TextColor3 = Color3.fromRGB(138, 43, 226)
SideTitle.Font = Enum.Font.GothamBold
SideTitle.TextSize = 16
SideTitle.BackgroundTransparency = 1
SideTitle.TextXAlignment = Enum.TextXAlignment.Left
SideTitle.Parent = SideBar

local Line1 = Instance.new("Frame")
Line1.Size = UDim2.new(1, 0, 0, 1)
Line1.Position = UDim2.new(0, 0, 0, 45)
Line1.BackgroundColor3 = Color3.fromHex("25252D")
Line1.BorderSizePixel = 0
Line1.Parent = SideBar

local ProfileFrame = Instance.new("Frame")
ProfileFrame.Size = UDim2.new(1, 0, 0, 60)
ProfileFrame.Position = UDim2.new(0, 0, 0, 46)
ProfileFrame.BackgroundTransparency = 1
ProfileFrame.Active = true
ProfileFrame.Parent = SideBar

local ProfileImage = Instance.new("ImageLabel")
ProfileImage.Size = UDim2.new(0, 35, 0, 35)
ProfileImage.Position = UDim2.new(0, 15, 0.5, -17)
ProfileImage.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
ProfileImage.Image = Players:GetUserThumbnailAsync(LocalPlayer.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size420x420)
ProfileImage.Parent = ProfileFrame
Instance.new("UICorner", ProfileImage).CornerRadius = UDim.new(1, 0)

local PlayerName = Instance.new("TextLabel")
PlayerName.Text = LocalPlayer.DisplayName
PlayerName.Size = UDim2.new(1, -60, 0, 15)
PlayerName.Position = UDim2.new(0, 58, 0.5, -12)
PlayerName.TextColor3 = Color3.new(1, 1, 1)
PlayerName.Font = Enum.Font.GothamBold; PlayerName.TextSize = 11
PlayerName.BackgroundTransparency = 1; PlayerName.TextXAlignment = Enum.TextXAlignment.Left
PlayerName.Parent = ProfileFrame

local PlayerTag = Instance.new("TextLabel")
PlayerTag.Text = "@" .. LocalPlayer.Name
PlayerTag.Size = UDim2.new(1, -60, 0, 15)
PlayerTag.Position = UDim2.new(0, 58, 0.5, 2)
PlayerTag.TextColor3 = Color3.fromRGB(150, 150, 150)
PlayerTag.Font = Enum.Font.Gotham; PlayerTag.TextSize = 10
PlayerTag.BackgroundTransparency = 1; PlayerTag.TextXAlignment = Enum.TextXAlignment.Left
PlayerTag.Parent = ProfileFrame

local Line2 = Instance.new("Frame")
Line2.Size = UDim2.new(1, 0, 0, 1)
Line2.Position = UDim2.new(0, 0, 0, 106)
Line2.BackgroundColor3 = Color3.fromHex("25252D")
Line2.BorderSizePixel = 0
Line2.Parent = SideBar

local GamesLabel = Instance.new("TextLabel")
GamesLabel.Text = "GAMES"
GamesLabel.Size = UDim2.new(1, -30, 0, 30)
GamesLabel.Position = UDim2.new(0, 15, 0, 107)
GamesLabel.TextColor3 = Color3.fromRGB(100, 100, 100)
GamesLabel.Font = Enum.Font.GothamBold; GamesLabel.TextSize = 9
GamesLabel.BackgroundTransparency = 1; GamesLabel.TextXAlignment = Enum.TextXAlignment.Left
GamesLabel.Parent = SideBar

local ContentHolder = Instance.new("Frame")
ContentHolder.Name = "ContentHolder"
ContentHolder.Size = UDim2.new(1, -151, 1, -38)
ContentHolder.Position = UDim2.new(0, 151, 0, 38)
ContentHolder.BackgroundTransparency = 1
ContentHolder.ClipsDescendants = true
ContentHolder.Parent = MainFrame

local WelcomePage = Instance.new("Frame")
WelcomePage.Name = "WelcomePage"
WelcomePage.Size = UDim2.new(1, 0, 1, 0)
WelcomePage.BackgroundTransparency = 1
WelcomePage.Visible = true
WelcomePage.Parent = ContentHolder

local WelcomeTitle = Instance.new("TextLabel")
WelcomeTitle.Text = "WELCOME TO VORTEX HUB"
WelcomeTitle.Size = UDim2.new(1, 0, 0, 20)
WelcomeTitle.Position = UDim2.new(0, 0, 0.5, -15)
WelcomeTitle.Font = Enum.Font.GothamBold; WelcomeTitle.TextSize = 16; WelcomeTitle.TextColor3 = Color3.fromRGB(138, 43, 226)
WelcomeTitle.BackgroundTransparency = 1; WelcomeTitle.Parent = WelcomePage

local WelcomeSub = Instance.new("TextLabel")
WelcomeSub.Text = "Select a game from the sidebar to begin"
WelcomeSub.Size = UDim2.new(1, 0, 0, 20)
WelcomeSub.Position = UDim2.new(0, 0, 0.5, 10)
WelcomeSub.Font = Enum.Font.Gotham; WelcomeSub.TextSize = 12; WelcomeSub.TextColor3 = Color3.fromRGB(150, 150, 150)
WelcomeSub.BackgroundTransparency = 1; WelcomeSub.Parent = WelcomePage

local function CreateSection(parent, name)
    local SectionFrame = Instance.new("Frame")
    SectionFrame.Name = name .. "_Section"
    SectionFrame.Size = UDim2.new(1, 0, 0, 25)
    SectionFrame.BackgroundTransparency = 1
    SectionFrame.Parent = parent

    local Dot = Instance.new("Frame")
    Dot.Size = UDim2.new(0, 6, 0, 6)
    Dot.Position = UDim2.new(0, 0, 0.5, -3)
    Dot.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
    Dot.BorderSizePixel = 0
    Dot.Parent = SectionFrame
    Instance.new("UICorner", Dot).CornerRadius = UDim.new(1, 0)

    local T = Instance.new("TextLabel")
    T.Text = name:upper()
    T.Size = UDim2.new(1, -15, 1, 0)
    T.Position = UDim2.new(0, 15, 0, 0)
    T.Font = Enum.Font.GothamBold; T.TextSize = 10; T.TextColor3 = Color3.fromRGB(100, 100, 100)
    T.BackgroundTransparency = 1; T.TextXAlignment = Enum.TextXAlignment.Left
    T.Parent = SectionFrame
end

local function CreateToggle(parent, name, desc, tag, callback)
    local Card = Instance.new("Frame")
    Card.Name = name .. "_Card"
    Card.BackgroundColor3 = Color3.fromHex("1C1C22")
    Card.Size = UDim2.new(0, 240, 0, 100) 
    Card.Parent = parent

    Instance.new("UICorner", Card).CornerRadius = UDim.new(0, 6)
    local CardStroke = Instance.new("UIStroke")
    CardStroke.Color = Color3.fromHex("25252D")
    CardStroke.Thickness = 1
    CardStroke.Parent = Card

    local T = Instance.new("TextLabel")
    T.Text = name; T.Size = UDim2.new(1, -80, 0, 20); T.Position = UDim2.new(0, 12, 0, 12)
    T.Font = Enum.Font.GothamBold; T.TextSize = 13; T.TextColor3 = Color3.new(1,1,1); T.BackgroundTransparency = 1; T.TextXAlignment = Enum.TextXAlignment.Left; T.Parent = Card

    local D = Instance.new("TextLabel")
    D.Text = desc; D.Size = UDim2.new(1, -85, 0, 35); D.Position = UDim2.new(0, 12, 0, 32)
    D.Font = Enum.Font.Gotham; D.TextSize = 10; D.TextColor3 = Color3.fromRGB(120,120,120); D.BackgroundTransparency = 1; D.TextXAlignment = Enum.TextXAlignment.Left; D.TextWrapped = true; D.Parent = Card

    local TagFrame = Instance.new("Frame")
    TagFrame.Size = UDim2.new(0, 55, 0, 18); TagFrame.Position = UDim2.new(0, 12, 1, -28)
    TagFrame.BackgroundColor3 = Color3.fromHex("25252D"); TagFrame.Parent = Card
    Instance.new("UICorner", TagFrame).CornerRadius = UDim.new(0, 4)

    local TagLabel = Instance.new("TextLabel")
    TagLabel.Text = tag:upper(); TagLabel.Size = UDim2.new(1, 0, 1, 0)
    TagLabel.Font = Enum.Font.GothamBold; TagLabel.TextSize = 8; TagLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
    TagLabel.BackgroundTransparency = 1; TagLabel.Parent = TagFrame

    local Btn = Instance.new("TextButton")
    Btn.Name = "ToggleBtn"
    Btn.Size = UDim2.new(0, 55, 0, 26); Btn.Position = UDim2.new(1, -67, 0.5, -13)
    Btn.BackgroundColor3 = Color3.fromHex("25252D"); Btn.Text = "OFF"; Btn.Font = Enum.Font.GothamBold; Btn.TextSize = 11; Btn.TextColor3 = Color3.new(1,1,1); Btn.Parent = Card
    Instance.new("UICorner", Btn).CornerRadius = UDim.new(0, 4)

    local state = false
    Btn.MouseButton1Click:Connect(function()
        state = not state
        Btn.Text = state and "ON" or "OFF"
        Btn.BackgroundColor3 = state and Color3.fromRGB(138, 43, 226) or Color3.fromHex("25252D")
        callback(state)
    end)
end

local function CreateButton(parent, name, desc, tag, callback)
    local Card = Instance.new("Frame")
    Card.Name = name .. "_Card"
    Card.BackgroundColor3 = Color3.fromHex("1C1C22")
    Card.Size = UDim2.new(0, 240, 0, 100) 
    Card.Parent = parent

    Instance.new("UICorner", Card).CornerRadius = UDim.new(0, 6)
    local CardStroke = Instance.new("UIStroke")
    CardStroke.Color = Color3.fromHex("25252D")
    CardStroke.Thickness = 1
    CardStroke.Parent = Card

    local T = Instance.new("TextLabel")
    T.Text = name; T.Size = UDim2.new(1, -90, 0, 20); T.Position = UDim2.new(0, 12, 0, 12)
    T.Font = Enum.Font.GothamBold; T.TextSize = 13; T.TextColor3 = Color3.new(1,1,1); T.BackgroundTransparency = 1; T.TextXAlignment = Enum.TextXAlignment.Left; T.Parent = Card

    local D = Instance.new("TextLabel")
    D.Text = desc; D.Size = UDim2.new(1, -95, 0, 35); D.Position = UDim2.new(0, 12, 0, 32)
    D.Font = Enum.Font.Gotham; D.TextSize = 10; D.TextColor3 = Color3.fromRGB(120,120,120); D.BackgroundTransparency = 1; D.TextXAlignment = Enum.TextXAlignment.Left; D.TextWrapped = true; D.Parent = Card

    local TagFrame = Instance.new("Frame")
    TagFrame.Size = UDim2.new(0, 55, 0, 18); TagFrame.Position = UDim2.new(0, 12, 1, -28)
    TagFrame.BackgroundColor3 = Color3.fromHex("25252D"); TagFrame.Parent = Card
    Instance.new("UICorner", TagFrame).CornerRadius = UDim.new(0, 4)

    local TagLabel = Instance.new("TextLabel")
    TagLabel.Text = tag:upper(); TagLabel.Size = UDim2.new(1, 0, 1, 0)
    TagLabel.Font = Enum.Font.GothamBold; TagLabel.TextSize = 8; TagLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
    TagLabel.BackgroundTransparency = 1; TagLabel.Parent = TagFrame

    local Btn = Instance.new("TextButton")
    Btn.Size = UDim2.new(0, 70, 0, 28); Btn.Position = UDim2.new(1, -82, 0.5, -14)
    Btn.BackgroundColor3 = Color3.fromRGB(138, 43, 226); Btn.Text = "Execute"; Btn.Font = Enum.Font.GothamBold; Btn.TextSize = 11; Btn.TextColor3 = Color3.new(1,1,1); Btn.Parent = Card
    Instance.new("UICorner", Btn).CornerRadius = UDim.new(0, 4)

    Btn.MouseButton1Click:Connect(callback)
end

local GamePages = {}
local function CreatePage(name)
    local Page = Instance.new("ScrollingFrame")
    Page.Name = name .. "_Page"
    Page.Size = UDim2.new(1, 0, 1, 0)
    Page.BackgroundTransparency = 1
    Page.BorderSizePixel = 0
    Page.Visible = false
    Page.ScrollBarThickness = 3
    Page.ScrollBarImageColor3 = Color3.fromRGB(138, 43, 226)
    Page.AutomaticCanvasSize = Enum.AutomaticSize.Y
    Page.Parent = ContentHolder

    local UIList = Instance.new("UIListLayout")
    UIList.Padding = UDim.new(0, 15)
    UIList.SortOrder = Enum.SortOrder.LayoutOrder
    UIList.Parent = Page

    local Padding = Instance.new("UIPadding")
    Padding.PaddingLeft = UDim.new(0, 20)
    Padding.PaddingTop = UDim.new(0, 20)
    Padding.PaddingRight = UDim.new(0, 25)
    Padding.PaddingBottom = UDim.new(0, 30)
    Padding.Parent = Page

    local PageHeader = Instance.new("Frame")
    PageHeader.Size = UDim2.new(1, 0, 0, 60)
    PageHeader.BackgroundTransparency = 1
    PageHeader.Parent = Page

    local PageTitleLabel = Instance.new("TextLabel")
    PageTitleLabel.Text = name
    PageTitleLabel.Size = UDim2.new(1, 0, 0, 25)
    PageTitleLabel.Font = Enum.Font.GothamBold
    PageTitleLabel.TextSize = 18
    PageTitleLabel.TextColor3 = Color3.new(1,1,1)
    PageTitleLabel.BackgroundTransparency = 1
    PageTitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    PageTitleLabel.Parent = PageHeader

    local PageSubLabel = Instance.new("TextLabel")
    PageSubLabel.Text = "Scripts and utilities available"
    PageSubLabel.Size = UDim2.new(1, 0, 0, 15)
    PageSubLabel.Position = UDim2.new(0, 0, 0, 28)
    PageSubLabel.Font = Enum.Font.Gotham
    PageSubLabel.TextSize = 11
    PageSubLabel.TextColor3 = Color3.fromRGB(120, 120, 120)
    PageSubLabel.BackgroundTransparency = 1
    PageSubLabel.TextXAlignment = Enum.TextXAlignment.Left
    PageSubLabel.Parent = PageHeader

    local PageSeparator = Instance.new("Frame")
    PageSeparator.Size = UDim2.new(1, 40, 0, 1)
    PageSeparator.Position = UDim2.new(0, -20, 0, 52)
    PageSeparator.BackgroundColor3 = Color3.fromHex("25252D")
    PageSeparator.BorderSizePixel = 0
    PageSeparator.Parent = PageHeader

    local function CreateScriptGrid(parent)
        local G = Instance.new("Frame")
        G.Size = UDim2.new(1, 0, 0, 0)
        G.BackgroundTransparency = 1
        G.AutomaticSize = Enum.AutomaticSize.Y
        G.Parent = parent
        local Grid = Instance.new("UIGridLayout")
        Grid.CellSize = UDim2.new(0, 240, 0, 100)
        Grid.CellPadding = UDim2.new(0, 15, 0, 15)
        Grid.SortOrder = Enum.SortOrder.LayoutOrder
        Grid.Parent = G
        return G
    end

    GamePages[name] = {Page = Page, CreateGrid = CreateScriptGrid}
    return GamePages[name]
end

local SelectedGame = nil
local GameButtons = {}

local function ShowPage(name)
    WelcomePage.Visible = false
    
    for gameName, btn in pairs(GameButtons) do
        if btn and btn.Parent then
            TweenService:Create(btn, TweenInfo.new(0.2), {
                BackgroundTransparency = 1,
                TextColor3 = Color3.fromRGB(200, 200, 200)
            }):Play()
        end
    end
    
    if GameButtons[name] then
        TweenService:Create(GameButtons[name], TweenInfo.new(0.2), {
            BackgroundTransparency = 0.7,
            BackgroundColor3 = Color3.fromRGB(138, 43, 226),
            TextColor3 = Color3.new(1, 1, 1)
        }):Play()
        SelectedGame = name
    end
    
    for pageName, pageData in pairs(GamePages) do
        pageData.Page.Visible = (pageName == name)
    end
end

local GamesList = Instance.new("ScrollingFrame")
GamesList.Name = "GamesList"
GamesList.Size = UDim2.new(1, 0, 0, 110)
GamesList.Position = UDim2.new(0, 0, 0, 137)
GamesList.BackgroundTransparency = 1
GamesList.BorderSizePixel = 0
GamesList.ScrollBarThickness = 2
GamesList.ScrollBarImageColor3 = Color3.fromRGB(138, 43, 226)
GamesList.CanvasSize = UDim2.new(0, 0, 0, 0)
GamesList.AutomaticCanvasSize = Enum.AutomaticSize.Y
GamesList.Active = true
GamesList.Parent = SideBar

local GamesLayout = Instance.new("UIListLayout")
GamesLayout.Padding = UDim.new(0, 4)
GamesLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
GamesLayout.Parent = GamesList

local function CreateMenuBtn(text, parent)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, 130, 0, 30)
    btn.BackgroundTransparency = 1
    btn.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
    btn.Text = "      " .. text
    btn.TextColor3 = Color3.fromRGB(200, 200, 200)
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 11
    btn.TextXAlignment = Enum.TextXAlignment.Left
    btn.Active = true
    btn.Parent = parent

    local bCorner = Instance.new("UICorner")
    bCorner.CornerRadius = UDim.new(0, 6)
    bCorner.Parent = btn

    GameButtons[text] = btn
    
    btn.MouseButton1Click:Connect(function() 
        ShowPage(text) 
    end)
    
    btn.MouseEnter:Connect(function()
        if SelectedGame ~= text then
            TweenService:Create(btn, TweenInfo.new(0.2), {
                BackgroundTransparency = 0.9,
                TextColor3 = Color3.fromRGB(138, 43, 226)
            }):Play()
        end
    end)
    btn.MouseLeave:Connect(function()
        if SelectedGame ~= text then
            TweenService:Create(btn, TweenInfo.new(0.2), {
                BackgroundTransparency = 1,
                TextColor3 = Color3.fromRGB(200, 200, 200)
            }):Play()
        end
    end)
    return btn
end

-- [[ PRISON LIFE CONFIGURATION ]]
local PL_Data = CreatePage("Prison Life")

CreateSection(PL_Data.Page, "Visuals")
local VisualGrid = PL_Data.CreateGrid(PL_Data.Page)

CreateToggle(VisualGrid, "ESP Players", "Visualiza TODOS os jogadores, independente do time.", "Visuals", function(v)
    PrisonLife:ToggleESP_Players(v)
end)

CreateToggle(VisualGrid, "ESP Bandidos", "Mostra jogadores do time Criminal (incluindo do seu time).", "Visuals", function(v)
    PrisonLife:ToggleESP_Bandits(v)
end)

CreateToggle(VisualGrid, "ESP Policiais", "Mostra jogadores do time Guards (incluindo do seu time).", "Visuals", function(v)
    PrisonLife:ToggleESP_Polices(v)
end)

CreateToggle(VisualGrid, "ESP Prisioneiros", "Mostra jogadores do time Inmates (incluindo do seu time).", "Visuals", function(v)
    PrisonLife:ToggleESP_Prisoners(v)
end)

CreateSection(PL_Data.Page, "Utilities")
local UtilGrid = PL_Data.CreateGrid(PL_Data.Page)

CreateToggle(UtilGrid, "Bypass Doors", "Remove a colisão de todas as portas da pasta Doors.", "World", function(v)
    PrisonLife:ToggleBypassDoors(v)
end)

CreateToggle(UtilGrid, "Auto KeyCard", "Pega KeyCard automaticamente quando dropado (verifica se já tem).", "Auto", function(v)
    PrisonLife:ToggleAutoKeyCard(v)
end)

CreateToggle(UtilGrid, "Auto M9", "Pega M9 automaticamente quando dropada (verifica se já tem).", "Auto", function(v)
    PrisonLife:ToggleAutoM9(v)
end)

CreateSection(PL_Data.Page, "Teleports")
local TPGrid = PL_Data.CreateGrid(PL_Data.Page)

CreateButton(TPGrid, "TP Out Prison", "Teletransporta para FORA da prisão.", "TP", function()
    PrisonLife:TeleportOutPrison()
end)

CreateButton(TPGrid, "TP Criminals Spawn", "Teletransporta para onde os bandidos nascem.", "TP", function()
    PrisonLife:TeleportCriminalSpawn()
end)

CreateButton(TPGrid, "TP Inside Prison", "Teletransporta para DENTRO da prisão (yard).", "TP", function()
    PrisonLife:TeleportInsidePrison()
end)

CreateButton(TPGrid, "TP Yard Center", "Teletransporta para o centro do pátio.", "TP", function()
    PrisonLife:TeleportYardCenter()
end)

CreateButton(TPGrid, "TP Police Station", "Teletransporta DENTRO do negócio da polícia.", "TP", function()
    PrisonLife:TeleportPoliceCenter()
end)

CreateSection(PL_Data.Page, "Prison Items")
local ItemsGrid = PL_Data.CreateGrid(PL_Data.Page)

CreateButton(ItemsGrid, "Get AK-47", "Pega a AK-47 (teleporta atrás para pisar e volta).", "Items", function()
    PrisonLife:GetAK47()
end)

CreateButton(ItemsGrid, "Get MP5", "Pega a MP5 (teleporta e volta automaticamente).", "Items", function()
    PrisonLife:GetMP5()
end)

CreateButton(ItemsGrid, "Get Shotgun", "Pega a escopeta - Volta auto.", "Items", function()
    PrisonLife:GetShotgun()
end)

-- [[ BLIND SHOT CONFIGURATION ]]
local BS_Data = CreatePage("Blind Shot")

CreateSection(BS_Data.Page, "Visuals")
local BlindGrid = BS_Data.CreateGrid(BS_Data.Page)

CreateToggle(BlindGrid, "ESP DEFINITIVE", "Intercepta renderização e força visibilidade (Sem ESP Azul)", "VISUAL", function(v)
    States.BlindShot_ESP = v
    
    if v then
        BlindShotESP:Enable()
    else
        BlindShotESP:Disable()
    end
end)

CreateSection(BS_Data.Page, "Auto Farm")
local AutoFarmGrid = BS_Data.CreateGrid(BS_Data.Page)

CreateToggle(AutoFarmGrid, "Auto TP to Trophy", "Teleporta automaticamente para o troféu a cada 20s", "FARM", function(v)
    States.Auto_Trophy = v
    
    if v then
        StartAutoTrophy()
    end
end)

CreateToggle(AutoFarmGrid, "Anti-AFK System", "Evita que você seja kickado por inatividade", "UTILITY", function(v)
    States.Anti_AFK = v
    
    if v then
        AntiAFK:Enable()
    else
        AntiAFK:Disable()
    end
end)

-- [[ FIND THE BRAINROT CONFIGURATION ]]
local BR_Data = CreatePage("Find the Brainrot")

CreateSection(BR_Data.Page, "Auto Farm")
local BrainrotGrid = BR_Data.CreateGrid(BR_Data.Page)

CreateToggle(BrainrotGrid, "Auto Brainrot Farm", "Teleporta automaticamente para todos os brainrots", "TELEPORT", function(v)
    States.Brainrot_Farm = v
    
    if v then
        BrainrotFarm:Enable()
    else
        BrainrotFarm:Disable()
    end
end)

CreateSection(BR_Data.Page, "Utilities")
local BrainrotUtilGrid = BR_Data.CreateGrid(BR_Data.Page)

CreateToggle(BrainrotUtilGrid, "Anti-AFK System", "Evita que você seja kickado por inatividade", "UTILITY", function(v)
    States.Anti_AFK = v
    
    if v then
        AntiAFK:Enable()
    else
        AntiAFK:Disable()
    end
end)

-- [[ WESTBOUND CONFIGURATION ]]
local WB_Data = CreatePage("Westbound")

CreateSection(WB_Data.Page, "Visuals")
local Westbound_ESPGrid = WB_Data.CreateGrid(WB_Data.Page)

CreateToggle(Westbound_ESPGrid, "ESP Players", "Mostra todos os jogadores no Westbound", "VISUAL", function(v)
    Westbound:ToggleESP_Players(v)
end)

CreateToggle(Westbound_ESPGrid, "ESP Animals", "Mostra todos os animais no Westbound", "VISUAL", function(v)
    Westbound:ToggleESP_Animals(v)
end)

CreateToggle(Westbound_ESPGrid, "ESP Distance + Name", "Mostra distância e nome dos jogadores", "VISUAL", function(v)
    Westbound:ToggleESP_DistanceName(v)
end)

CreateToggle(Westbound_ESPGrid, "ESP Name", "Mostra apenas os nomes dos jogadores", "VISUAL", function(v)
    Westbound:ToggleESP_Name(v)
end)

-- [[ FNAF: ETERNAL NIGHTS CONFIGURATION - NOVAS CATEGORIAS ]]
local FNAF_Data = CreatePage("FNAF: Eternal Nights")

-- VISUALS acima de TELEPORTS (como solicitado)
CreateSection(FNAF_Data.Page, "Visuals")
local FNAF_ESPGrid = FNAF_Data.CreateGrid(FNAF_Data.Page)

CreateToggle(FNAF_ESPGrid, "ESP Players", "Mostra todos os jogadores", "VISUAL", function(v)
    FNAF:ApplyESP_Players(v)
end)

CreateToggle(FNAF_ESPGrid, "ESP Animatronics", "Mostra todos os animatrônicos", "VISUAL", function(v)
    FNAF:ApplyESP_Animatronics(v)
end)

CreateToggle(FNAF_ESPGrid, "ESP Fuses", "Mostra todos os fusíveis", "VISUAL", function(v)
    FNAF:ApplyESP_Fuses(v)
end)

CreateToggle(FNAF_ESPGrid, "ESP Batteries", "Mostra todas as baterias", "VISUAL", function(v)
    FNAF:ApplyESP_Batteries(v)
end)

CreateToggle(FNAF_ESPGrid, "ESP Pliers", "Mostra todos os alicates", "VISUAL", function(v)
    FNAF:ApplyESP_Pliers(v)
end)

CreateToggle(FNAF_ESPGrid, "ESP Screwdriver", "Mostra todas as chaves de fenda", "VISUAL", function(v)
    FNAF:ApplyESP_Screwdriver(v)
end)

CreateToggle(FNAF_ESPGrid, "ESP Cabinet", "Mostra os armários", "VISUAL", function(v)
    FNAF:ApplyESP_Cabinet(v)
end)

CreateToggle(FNAF_ESPGrid, "ESP Camera", "Mostra as câmeras", "VISUAL", function(v)
    FNAF:ApplyESP_Camera(v)
end)

CreateToggle(FNAF_ESPGrid, "ESP Flashlight", "Mostra as lanternas", "VISUAL", function(v)
    FNAF:ApplyESP_Flashlight(v)
end)

CreateToggle(FNAF_ESPGrid, "ESP ALL", "Ativa todos os ESPs de uma vez", "VISUAL", function(v)
    FNAF:ApplyESP_All(v)
end)

-- TELEPORTS (agora abaixo de VISUALS)
CreateSection(FNAF_Data.Page, "Teleports")
local FNAF_TeleportGrid = FNAF_Data.CreateGrid(FNAF_Data.Page)

CreateButton(FNAF_TeleportGrid, "TP Security Room", "Teleport para a sala de segurança", "TP", function()
    FNAF:TeleportSecurityRoom()
end)

CreateButton(FNAF_TeleportGrid, "TP Puppet Clock", "Teleport para o relógio da Puppet", "TP", function()
    FNAF:TeleportPuppetClock()
end)

CreateButton(FNAF_TeleportGrid, "TP Above Map", "Teleport para cima do mapa", "TP", function()
    FNAF:TeleportAboveMap()
end)

CreateButton(FNAF_TeleportGrid, "TP Fuse Room", "Teleport para sala dos fusíveis", "TP", function()
    FNAF:TeleportFuseRoom()
end)

-- NOVA CATEGORIA: PULL ITEMS (botões executar)
CreateSection(FNAF_Data.Page, "Pull Items")
local FNAF_PullItemsGrid = FNAF_Data.CreateGrid(FNAF_Data.Page)

CreateButton(FNAF_PullItemsGrid, "Pull All Items", "Puxa TODOS os itens do mapa para você", "PULL", function()
    FNAF:ExecutePullItem("AllItems")
end)

CreateButton(FNAF_PullItemsGrid, "Pull Batteries", "Puxa todas as baterias para você", "PULL", function()
    FNAF:ExecutePullItem("Batteries")
end)

CreateButton(FNAF_PullItemsGrid, "Pull Camera", "Puxa a câmera para você", "PULL", function()
    FNAF:ExecutePullItem("Camera")
end)

CreateButton(FNAF_PullItemsGrid, "Pull Fuses", "Puxa todos os fusíveis para você", "PULL", function()
    FNAF:ExecutePullItem("Fuses")
end)

CreateButton(FNAF_PullItemsGrid, "Pull Pliers", "Puxa todos os alicates para você", "PULL", function()
    FNAF:ExecutePullItem("Pliers")
end)

CreateButton(FNAF_PullItemsGrid, "Pull Screwdriver", "Puxa todas as chaves de fenda para você", "PULL", function()
    FNAF:ExecutePullItem("Screwdriver")
end)

-- NOVA CATEGORIA: UTILITIES (ON/OFF)
CreateSection(FNAF_Data.Page, "Utilities")
local FNAF_UtilitiesGrid = FNAF_Data.CreateGrid(FNAF_Data.Page)

CreateToggle(FNAF_UtilitiesGrid, "Clock Game", "Ativa o jogo do relógio automaticamente", "UTILITY", function(v)
    FNAF:ToggleClockGame(v)
end)

CreateToggle(FNAF_UtilitiesGrid, "Clock Puppet", "Ativa o relógio da Puppet automaticamente", "UTILITY", function(v)
    FNAF:ToggleClockPuppet(v)
end)

CreateToggle(FNAF_UtilitiesGrid, "Full Brightness", "Liga o fullbright (iluminação total)", "UTILITY", function(v)
    FNAF:ToggleFullBrightness(v)
end)

CreateToggle(FNAF_UtilitiesGrid, "Speed Hack", "Aumenta sua velocidade de movimento", "UTILITY", function(v)
    FNAF:ToggleSpeed(v)
end)

CreateMenuBtn("Prison Life", GamesList)
CreateMenuBtn("Blind Shot", GamesList)
CreateMenuBtn("Find the Brainrot", GamesList)
CreateMenuBtn("Westbound", GamesList)
CreateMenuBtn("FNAF: Eternal Nights", GamesList)

local Line3 = Instance.new("Frame")
Line3.Size = UDim2.new(1, 0, 0, 1)
Line3.Position = UDim2.new(0, 0, 0, 250)
Line3.BackgroundColor3 = Color3.fromHex("25252D")
Line3.BorderSizePixel = 0
Line3.Parent = SideBar

local MenuLabel = Instance.new("TextLabel")
MenuLabel.Text = "MENU"
MenuLabel.Size = UDim2.new(1, -30, 0, 30)
MenuLabel.Position = UDim2.new(0, 15, 0, 251)
MenuLabel.TextColor3 = Color3.fromRGB(100, 100, 100)
MenuLabel.Font = Enum.Font.GothamBold
MenuLabel.TextSize = 9
MenuLabel.BackgroundTransparency = 1
MenuLabel.TextXAlignment = Enum.TextXAlignment.Left
MenuLabel.Parent = SideBar

local MenuList = Instance.new("ScrollingFrame")
MenuList.Name = "MenuList"
MenuList.Size = UDim2.new(1, 0, 0, 75)
MenuList.Position = UDim2.new(0, 0, 0, 281)
MenuList.BackgroundTransparency = 1
MenuList.BorderSizePixel = 0
MenuList.ScrollBarThickness = 2
MenuList.ScrollBarImageColor3 = Color3.fromRGB(138, 43, 226)
MenuList.CanvasSize = UDim2.new(0, 0, 0, 0)
MenuList.AutomaticCanvasSize = Enum.AutomaticSize.Y
MenuList.Active = true
MenuList.Parent = SideBar

local MenuLayout = Instance.new("UIListLayout")
MenuLayout.Padding = UDim.new(0, 4)
MenuLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
MenuLayout.Parent = MenuList

CreateMenuBtn("Settings", MenuList); CreatePage("Settings")
CreateMenuBtn("Discord", MenuList); CreatePage("Discord")
CreateMenuBtn("Credits", MenuList); CreatePage("Credits")

local FooterSeparator = Instance.new("Frame")
FooterSeparator.Size = UDim2.new(1, 0, 0, 1)
FooterSeparator.Position = UDim2.new(0, 0, 0, 362)
FooterSeparator.BackgroundColor3 = Color3.fromHex("25252D")
FooterSeparator.BorderSizePixel = 0
FooterSeparator.Parent = SideBar

local FooterGroup = Instance.new("Frame")
FooterGroup.Name = "FooterGroup"
FooterGroup.Size = UDim2.new(1, 0, 0, 50)
FooterGroup.Position = UDim2.new(0, 0, 0, 363)
FooterGroup.BackgroundTransparency = 1
FooterGroup.Parent = SideBar

local FooterLayout = Instance.new("UIListLayout")
FooterLayout.VerticalAlignment = Enum.VerticalAlignment.Center
FooterLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
FooterLayout.Padding = UDim.new(0, 2)
FooterLayout.Parent = FooterGroup

local VersionLabelBottom = Instance.new("TextLabel")
VersionLabelBottom.Text = "v2.3.0"
VersionLabelBottom.Size = UDim2.new(1, 0, 0, 14)
VersionLabelBottom.TextColor3 = Color3.fromRGB(80, 85, 85)
VersionLabelBottom.Font = Enum.Font.Gotham
VersionLabelBottom.TextSize = 10
VersionLabelBottom.BackgroundTransparency = 1
VersionLabelBottom.Parent = FooterGroup

local DevLabelFinal = Instance.new("TextLabel")
DevLabelFinal.Size = UDim2.new(1, 0, 0, 14)
DevLabelFinal.BackgroundTransparency = 1
DevLabelFinal.RichText = true
DevLabelFinal.Text = "<font color='#646464'>Developed by</font> <font color='#8A2BE2'>Y otra</font>"
DevLabelFinal.Font = Enum.Font.Gotham
DevLabelFinal.TextSize = 10
DevLabelFinal.Parent = FooterGroup

-- [[ DRAG & KEYBIND - INSERT CORRIGIDO ]]
local dragging, dragInput, dragStart, startPos
local function update(input)
    local delta = input.Position - dragStart
    MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

TopBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

TopBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)

-- CORREÇÃO: Bind Insert funcionando corretamente
UserInputService.InputBegan:Connect(function(input, processed)
    if not processed and input.KeyCode == Enum.KeyCode.Insert then
        MainFrame.Visible = not MainFrame.Visible
        print("[Vortex Hub] Interface " .. (MainFrame.Visible and "aberta" or "fechada") .. " via Insert")
    end
end)

print("[Vortex Hub] Script loaded successfully! v2.3.0")
print("[Vortex Hub] NOVAS ATUALIZAÇÕES IMPLEMENTADAS:")
print("[Vortex Hub] 1. FNAF: Eternal Nights com novas categorias:")
print("[Vortex Hub]   - VISUALS agora aparece acima de TELEPORTS")
print("[Vortex Hub]   - PULL ITEMS (6 botões de executar)")
print("[Vortex Hub]   - UTILITIES (4 toggles ON/OFF)")
print("[Vortex Hub] 2. Sistema completo e funcional!")
print("[Vortex Hub] Use INSERT para abrir/fechar a interface!")