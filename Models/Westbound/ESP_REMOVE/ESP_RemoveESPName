local Players = game:GetService("Players")

-- 1. Desativa as variáveis globais (caso existam)
_G.NameESP_Enabled = false

-- 2. Limpa as conexões registradas
if _G.NameESP_Connections then
    for _, conn in pairs(_G.NameESP_Connections) do
        if conn then conn:Disconnect() end
    end
    _G.NameESP_Connections = {}
end

-- 3. Função para remover e impedir que o Billboard volte
local function cleanup(character)
    if character then
        local nameESP = character:FindFirstChild("OnlyNameESP")
        if nameESP then
            nameESP:Destroy()
        end
    end
end

-- 4. Varredura imediata em todos os jogadores
for _, player in pairs(Players:GetPlayers()) do
    cleanup(player.Character)
    
    -- Tenta desconectar eventos CharacterAdded que possam estar ativos
    -- Nota: Isso só funciona se as conexões foram salvas em variáveis.
    -- Para garantir, vamos forçar a remoção sempre que algo for adicionado
    player.CharacterAdded:Connect(function(char)
        if not _G.NameESP_Enabled then
            task.wait(0.5) -- Espera o outro script criar para poder deletar
            cleanup(char)
        end
    end)
end

print("[ESP NOME] LIMPO E BLOQUEADO")