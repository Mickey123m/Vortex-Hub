-- Script Aimbot "Stick Hard" (Grudar Máximo - Prioridade Suprema)
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")

local LocalPlayer = Players.LocalPlayer
local Camera = Workspace.CurrentCamera

-- Controle Global
if _G.AimbotToggle == nil then _G.AimbotToggle = false end
_G.AimbotToggle = not _G.AimbotToggle

-- Configurações de Força Total
local AIM_KEY = Enum.KeyCode.LeftControl
local FOV_RADIUS = 500 -- Raio de busca maior
local TARGET_PART = "Head" -- Parte do corpo para grudar

if not _G.AimbotToggle then
    RunService:UnbindFromRenderStep("HardLockAimbot")
    _G.AimbotConnection = nil
    warn("Aimbot Hard Stick: DESATIVADO")
    return
end

-- Função de visibilidade (Raycast) para não grudar na parede
local function isVisible(part, character)
    local rayParams = RaycastParams.new()
    rayParams.FilterType = Enum.RaycastFilterType.Exclude
    rayParams.FilterDescendantsInstances = {LocalPlayer.Character, character, Camera}
    
    local ray = Workspace:Raycast(Camera.CFrame.Position, (part.Position - Camera.CFrame.Position), rayParams)
    return ray == nil
end

-- Busca o inimigo mais próximo do cursor
local function getTarget()
    local closestTarget = nil
    local minDistance = FOV_RADIUS

    local charFolder = Workspace:FindFirstChild("Characters")
    if not charFolder then return nil end

    local ct = charFolder:FindFirstChild("Counter-Terrorists")
    local tr = charFolder:FindFirstChild("Terrorists")
    
    -- Detecta seu time e define inimigos
    local myTeam = (ct and ct:FindFirstChild(LocalPlayer.Name)) and "CT" or "TR"
    local enemyFolder = (myTeam == "CT") and tr or ct

    if enemyFolder then
        for _, enemy in pairs(enemyFolder:GetChildren()) do
            local head = enemy:FindFirstChild(TARGET_PART)
            local hum = enemy:FindFirstChildOfClass("Humanoid")
            
            if head and hum and hum.Health > 0 then
                local screenPos, onScreen = Camera:WorldToViewportPoint(head.Position)
                
                if onScreen then
                    local dist = (Vector2.new(screenPos.X, screenPos.Y) - Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)).Magnitude
                    
                    if dist < minDistance then
                        if isVisible(head, enemy) then
                            minDistance = dist
                            closestTarget = head
                        end
                    end
                end
            end
        end
    end
    return closestTarget
end

-- BIND DE PRIORIDADE SUPREMA (Roda após todos os scripts do jogo)
RunService:BindToRenderStep("HardLockAimbot", Enum.RenderPriority.Last.Value, function()
    if UserInputService:IsKeyDown(AIM_KEY) then
        local target = getTarget()
        if target then
            -- Força o CFrame da Câmera sem suavização (Gruda instantâneo)
            Camera.CFrame = CFrame.new(Camera.CFrame.Position, target.Position)
        end
    end
end)

_G.AimbotConnection = true
print("Aimbot STICK HARD: ATIVADO (Grudando no máximo)")