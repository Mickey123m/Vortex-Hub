-- Cole este código no seu repositório GitHub e use a URL no hub
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")

local LocalPlayer = Players.LocalPlayer
local Camera = Workspace.CurrentCamera

-- VARIÁVEL GLOBAL DO HUB
local AIM_KEY = _G.AIM_KEY_WALLCHECK or _G.AIM_KEY or Enum.KeyCode.LeftControl
local TARGET_PART = "Head"

-- Sistema de toggle
if _G.AimbotWallCheckActive == nil then
    _G.AimbotWallCheckActive = false
end

-- Alternar estado
if _G.AimbotWallCheckActive then
    if RunService:IsBoundToRenderStep("VortexAimbotWallCheck") then
        RunService:UnbindFromRenderStep("VortexAimbotWallCheck")
    end
    _G.AimbotWallCheckActive = false
    return
else
    _G.AimbotWallCheckActive = true
end

-- Verificar se o hub definiu uma key
if _G.AIM_KEY_WALLCHECK then
    AIM_KEY = _G.AIM_KEY_WALLCHECK
elseif _G.AIM_KEY then
    AIM_KEY = _G.AIM_KEY
end

local function isVisible(part, character)
    if not LocalPlayer.Character then return false end
    
    local rayParams = RaycastParams.new()
    rayParams.FilterType = Enum.RaycastFilterType.Exclude
    
    local filterList = {Camera}
    
    if LocalPlayer.Character then
        table.insert(filterList, LocalPlayer.Character)
    end
    
    if character then
        table.insert(filterList, character)
    end
    
    rayParams.FilterDescendantsInstances = filterList
    
    local rayOrigin = Camera.CFrame.Position
    local rayDirection = (part.Position - rayOrigin)
    local ray = Workspace:Raycast(rayOrigin, rayDirection, rayParams)
    
    return ray == nil
end

local function getTarget()
    local closestTarget = nil
    local minDistance = math.huge

    local charFolder = Workspace:FindFirstChild("Characters")
    if not charFolder then return nil end

    local ct = charFolder:FindFirstChild("Counter-Terrorists")
    local tr = charFolder:FindFirstChild("Terrorists")
    
    local myTeam = "Unknown"
    if LocalPlayer.Character then
        if ct and ct:FindFirstChild(LocalPlayer.Name) then
            myTeam = "CT"
        elseif tr and tr:FindFirstChild(LocalPlayer.Name) then
            myTeam = "TR"
        end
    end
    
    local enemyFolder = (myTeam == "CT") and tr or ct

    if enemyFolder then
        for _, enemy in pairs(enemyFolder:GetChildren()) do
            local head = enemy:FindFirstChild(TARGET_PART)
            local hum = enemy:FindFirstChildOfClass("Humanoid")
            
            if head and hum and hum.Health > 0 then
                local screenPos, onScreen = Camera:WorldToViewportPoint(head.Position)
                
                if onScreen then
                    local dist = (Vector2.new(screenPos.X, screenPos.Y) - Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)).Magnitude
                    
                    if dist < minDistance then
                        if isVisible(head, enemy) then
                            minDistance = dist
                            closestTarget = head
                        end
                    end
                end
            end
        end
    end
    return closestTarget
end

-- Loop principal
local function aimbotLoop()
    local keyPressed = false
    
    if AIM_KEY == Enum.KeyCode.Unknown then
        if _G.AIM_MOUSEBUTTON == 1 then
            keyPressed = UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton1)
        elseif _G.AIM_MOUSEBUTTON == 2 then
            keyPressed = UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton2)
        elseif _G.AIM_MOUSEBUTTON == 3 then
            keyPressed = UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton3)
        end
    else
        keyPressed = UserInputService:IsKeyDown(AIM_KEY)
    end
    
    if keyPressed then
        local target = getTarget()
        if target then
            Camera.CFrame = CFrame.new(Camera.CFrame.Position, target.Position)
        end
    end
end

-- Ativar
RunService:BindToRenderStep("VortexAimbotWallCheck", Enum.RenderPriority.Last.Value, aimbotLoop)

-- Função de desativação
local function DeactivateAimbotWallCheck()
    if RunService:IsBoundToRenderStep("VortexAimbotWallCheck") then
        RunService:UnbindFromRenderStep("VortexAimbotWallCheck")
    end
    _G.AimbotWallCheckActive = false
end

-- Manter referência
_G.VortexAimbotWallCheckDeactivate = DeactivateAimbotWallCheck

return DeactivateAimbotWallCheck