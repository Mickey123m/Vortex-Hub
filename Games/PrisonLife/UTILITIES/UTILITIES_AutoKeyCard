-- Auto KeyCard (Ativar)
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

_G.AutoKeyActive = true -- Variável global obrigatória

local function HasKeyCard()
    local b = LocalPlayer:FindFirstChild("Backpack")
    local c = LocalPlayer.Character
    if b then for _, i in pairs(b:GetChildren()) do if string.find(i.Name:lower(), "key") then return true end end end
    if c then for _, i in pairs(c:GetChildren()) do if string.find(i.Name:lower(), "key") then return true end end end
    return false
end

task.spawn(function()
    print("[Prison Life] Auto KeyCard: ATIVADO")
    while _G.AutoKeyActive do
        if not HasKeyCard() then
            local found = nil
            local targets = {workspace, workspace:FindFirstChild("DroppedItems")}
            for _, p in pairs(targets) do
                if p then
                    for _, i in pairs(p:GetChildren()) do
                        if string.find(i.Name:lower(), "key") and (i:IsA("Tool") or i:IsA("Model")) then
                            found = i break
                        end
                    end
                end
                if found then break end
            end

            if found then
                local char = LocalPlayer.Character
                local hrp = char and char:FindFirstChild("HumanoidRootPart")
                if hrp then
                    local originalPos = hrp.CFrame
                    local targetPos = found:GetPivot().Position
                    local camDir = (Camera.CFrame.Position - targetPos).Unit
                    hrp.CFrame = CFrame.new(targetPos + Vector3.new(0, 10, 0) + (camDir * 4), targetPos)
                    
                    task.spawn(function()
                        for i = 1, 15 do
                            if workspace:FindFirstChild("Remote") and workspace.Remote:FindFirstChild("ItemHandler") then
                                workspace.Remote.ItemHandler:InvokeServer(found)
                            end
                            task.wait(0.05)
                        end
                    end)
                    task.wait(2.0)
                    hrp.CFrame = originalPos
                end
            end
        end
        task.wait(1)
    end
    print("[Prison Life] Auto KeyCard: PARADO")
end)