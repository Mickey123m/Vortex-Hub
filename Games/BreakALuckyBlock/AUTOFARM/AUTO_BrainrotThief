local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer

local function parseCashValue(text)
    if not text then return 0 end
    local cleanText = text:lower():gsub("[^%d%.km]", "")
    local value = tonumber(cleanText:match("[%d%.]+"))
    if not value then return 0 end
    if cleanText:find("k") then return value * 1000
    elseif cleanText:find("m") then return value * 1000000 end
    return value
end

local function resetSlapCooldown()
    player:SetAttribute("SlapCooldown", 0) 
end

local function getSlapHand()
    return player.Backpack:FindFirstChild("Slap Hand") or (player.Character and player.Character:FindFirstChild("Slap Hand"))
end

if _G.BountyHunter == nil then 
    _G.BountyHunter = false 
end

if not _G.ValorAlvoBounty then
    _G.ValorAlvoBounty = 100
end

if not _G.BountyHunter then
    _G.BountyHunter = true
end

local function runThiefLogic()
    while _G.BountyHunter do
        local tool = getSlapHand()
        local brainrotsModel = Workspace:FindFirstChild("Brainrots")
        
        if tool and brainrotsModel then
            for _, brainrot in pairs(brainrotsModel:GetChildren()) do
                if not _G.BountyHunter then break end
                
                local cashLabel = brainrot:FindFirstChild("CharCash", true)
                local valorTexto = cashLabel and cashLabel.Text or "0"
                
                if parseCashValue(valorTexto) >= _G.ValorAlvoBounty then
                    for _, otherPlayer in pairs(Players:GetPlayers()) do
                        if otherPlayer ~= player and otherPlayer.Character and otherPlayer.Character:FindFirstChild("HumanoidRootPart") then
                            local targetRoot = otherPlayer.Character.HumanoidRootPart
                            local dist = (targetRoot.Position - brainrot:GetPivot().Position).Magnitude
                            
                            if dist < 8 then
                                local myRoot = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
                                if myRoot then
                                    myRoot.CFrame = targetRoot.CFrame * CFrame.new(0, 0, 3)
                                    tool.Parent = player.Character
                                    
                                    resetSlapCooldown()
                                    tool:Activate()
                                    
                                    local remote = tool:FindFirstChild("Slap") or tool:FindFirstChildOfClass("RemoteEvent")
                                    if remote then
                                        remote:FireServer(targetRoot)
                                    end
                                    
                                    task.wait(0.5)
                                end
                            end
                        end
                    end
                end
            end
        end
        task.wait(0.2)
    end
end

RunService.Heartbeat:Connect(function()
    if _G.BountyHunter then
        resetSlapCooldown()
    end
end)

task.spawn(runThiefLogic)

if game:GetService("StarterGui"):SetCore then
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Vortex Hub",
        Text = "AUTO THIEF: ATIVADO",
        Duration = 3
    })
end

return function()
    _G.BountyHunter = false
end